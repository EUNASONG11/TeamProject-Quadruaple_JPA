import{u as G,j as e,R as Ne,x as be,W as Ce,X as V,r as a,g as O,b as u,d as U,f as ve,F as ke,P as we}from"./index-Ci2k4qFh.js";import{a as Se}from"./index-Bb-AHvvo.js";import{C as Ie}from"./CenterModal-BWpKwMNs.js";import{a as K}from"./pic-Jp7D6aQ0.js";import{c as X,a as Re}from"./match-CsZKVY0N.js";import{A as $e,a as Ae}from"./index-2cOcDuMQ.js";import{R as Te}from"./index-C8XM4V8E.js";import{L as _e}from"./index-DS9OfELJ.js";import{c as d,o as z}from"./search-1EubG62x.js";import{F as T}from"./index-N7y8gblw.js";import{I as Le}from"./index-D8xJHd2S.js";import{C as H}from"./index-CaNrhO1F.js";import{B as Fe}from"./button-wUgNsQBt.js";import"./index-B2xZeB-i.js";import"./index-DQsKIu_Q.js";import"./useId-D-Ytk-B6.js";import"./index-n5wX8XHp.js";import"./index-Iuc15HtX.js";import"./Portal-CM-16Ier.js";import"./useSize-D9liuY7G.js";import"./ContextIsolator-DxC-8vna.js";import"./context-n6vFpcCh.js";import"./collapse-BbEVqHco.js";import"./index-6qsLbnf5.js";import"./useLocale-taARNDpF.js";import"./BaseInput-DHAS3V0s.js";import"./Checkbox-CP6SBddq.js";const Me=g=>{g.current.scrollIntoView({behavior:"smooth"})},m=({showMore:g=!0,title:o,categoryData:x,searchValue:h,buttonClick:y})=>{const j=G(),_=c=>{j(`/contents/index?strfId=${c.strfId}`)};return e.jsxs("div",{className:"flex flex-col gap-[20px] items-center",children:[e.jsx("h2",{className:"w-full text-[24px] font-semibold text-slate-700",children:o}),e.jsx("ul",{className:"w-full flex flex-col gap-[20px] mb-[30px]",children:x==null?void 0:x.map((c,N)=>{var r,f;return e.jsxs("li",{className:"flex gap-[20px] items-center cursor-pointer",onClick:()=>{_(c)},children:[e.jsx("div",{className:"w-[130px] h-[130px] bg-slate-200 rounded-[8px] overflow-hidden",children:e.jsx("img",{src:`${K}${c.strfId}/${c.strfPic}`,alt:c.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-[5px]",children:[e.jsx("div",{className:"flex gap-[5px] items-center ",children:e.jsx("h3",{className:"text-[20px] font-semibold text-slate-700",children:c.title||c.strfTitle})}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("p",{className:"text-[14px] text-slate-500",children:X(c.category)}),e.jsx("p",{className:"text-[14px] text-slate-500",children:"|"}),e.jsx("p",{className:"text-[14px] text-slate-500",children:c.locationName})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx(Te,{disabled:!0,count:1,value:c.hasMyReview!==0?1:0}),e.jsx("p",{className:"text-[12px] text-slate-500",children:c.averageRating?c.averageRating:c.ratingAvg?c.ratingAvg:"0"}),e.jsxs("p",{className:"text-[12px] text-slate-500",children:["(",(r=c.reviewCount)==null?void 0:r.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("div",{children:c.wishIn?e.jsx($e,{className:"text-secondary3"}):e.jsx(Ae,{className:"text-slate-400"})}),e.jsx("p",{className:"text-[12px] text-slate-500",children:(f=c.wishlistCount)==null?void 0:f.toLocaleString()})]})]})]},N)})}),g&&e.jsxs("button",{type:"button",className:`px-[20px] py-[10px] border border-slate-300 \r
\r
        rounded-[24px] text-[16px] font-semibold text-slate-600`,onClick:y,children:[o," 검색결과 더보기"]})]})},xt=()=>{var W;const[g]=T.useForm(),[o,x]=Ne(be);Ce(V),a.useEffect(()=>{console.log("searchRecoil",o)},[o]);const h=O("accessToken");(W=O("user"))==null||W.userId;const y=a.useRef(null),j=G(),_=()=>{j(-1),V()},[c,N]=a.useState(o.searchWord!==""),[r,f]=a.useState(o.searchWord||""),[l,b]=a.useState(o.searchData||[]),[E,C]=a.useState(o.startIndex||0),[v,Y]=a.useState([]),[k,q]=a.useState([]),[w,J]=a.useState([]),[i,P]=a.useState(o.category||0),[S,Q]=a.useState(0),[Z,L]=a.useState(!1),[ee,I]=a.useState(!1),[R,F]=a.useState(!0),[De,te]=a.useState([]),se=a.useCallback(async()=>{const t="/api/search/popular";try{const s=await u.get(t);Y(s.data.data)}catch(s){console.log("인기 검색어",s)}},[]),M=a.useCallback(async()=>{try{const s=(await U.get("/api/search/basic")).data;q(s.data)}catch(t){console.log("최근 본 검색 결과",t)}},[]),ae=a.useCallback(async()=>{try{const n=(await U.get("/api/search/list")).data.data.filter(p=>p.txt!=="");J(n)}catch(t){console.log("최근 검색어 호출 결과:",t)}},[]),le=a.useCallback(async t=>{const s={strf_id:t.strfId};try{const n=await u.patch(`/api/recent/hide?strf_id=${t.strfId}`,{...s},{headers:{Authorization:`Bearer ${h}`}});console.log(n.data),n.data&&M()}catch(n){console.log("개별 삭제",n)}},[]),re=a.useCallback(async()=>{try{const t=await u.patch("/api/recent/hide/all",{},{headers:{Authorization:`Bearer ${h}`}});console.log(t.data),t.data&&(M(),L(!1))}catch(t){console.log("개별 삭제",t)}},[]),D=a.useCallback(async t=>{try{const n=(await u.get(`/api/search/all?search_word=${t}`)).data;n&&(I(!0),N(!0)),b(n.data)}catch(s){console.log("전체 검색",s)}},[]),B=a.useCallback(async()=>{var t;try{const s=E,p=(await u.get(`/api/search/category?start_idx=${s}&category=${d[i].name}&search_word=${r}&order_type=${z[S].type}`)).data;p&&I(!0),p.data&&p.data.length>0&&(b(ye=>s===0?p.data:[...ye,...p.data]),C(s+10)),((t=p.data[0])==null?void 0:t.more)===!1&&F(!1)}catch(s){console.log("카테고리 검색",s)}},[i,E,r,S]),ce=a.useCallback(async t=>{try{const s=await u.get(`/api/search/filter?start_idx=0&category=숙소&search_word=${o.searchWord}&${t}`);console.log("편의시설",s.data);const n=s.data;n.data.more===!1&&F(!1),b(n.data)}catch(s){console.log("편의시설",s)}},[]),oe=l==null?void 0:l.filter(t=>t.category==="TOUR"),ne=l==null?void 0:l.filter(t=>t.category==="STAY"),ie=l==null?void 0:l.filter(t=>t.category==="RESTAUR"),xe=l==null?void 0:l.filter(t=>t.category==="FEST"),pe=t=>{f(t.target.value)},de=a.useCallback(t=>{console.log("클릭한 최근 검색어:",t),f(t.txt),D(t.txt)},[]),me=a.useCallback(t=>{console.log("클릭한 인기 검색어:",t),j(`/contents/index?strfId=${t.strfId}`)},[]),he=a.useCallback(t=>{console.log("클릭한 최근 본 목록:",t),j(`/contents/index?strfId=${t.strfId}`)},[]),fe=a.useCallback(()=>{f("")},[]),ue=()=>{L(!1)},ge=t=>{r.trim()&&(I(!1),D(t.target.value),x({...o,searchWord:r}),N(!0))},$=t=>{Me(y),P(t),x({...o,category:t})},A=()=>{B()},je=t=>{var n;console.log("values",t.amenities),te(t.amenities);const s=(n=t.amenities)==null?void 0:n.map(p=>`amenity_id=${p}`).join("&");console.log("amenityIds",s),ce(s)};return a.useEffect(()=>{se(),h&&(M(),ae())},[]),a.useEffect(()=>{r!==""&&x({...o,searchWord:r})},[r]),a.useEffect(()=>{if(C(0),I(!1),b([]),F(!0),x(t=>({...t,startIndex:0,searchData:[]})),r.trim()){const t=setTimeout(()=>{i!==0?B():D(r)},100);return()=>clearTimeout(t)}},[i,S]),a.useEffect(()=>{(l==null?void 0:l.length)>0&&x({...o,searchData:l})},[l]),e.jsxs("div",{className:"w-full flex flex-col gap-[30px] mb-[100px]",children:[e.jsxs("div",{className:"w-full px-[32px] py-[30px] flex items-center gap-[40px] relative",ref:y,children:[e.jsx("div",{className:"text-[36px] cursor-pointer",onClick:()=>{_()},children:e.jsx(ve,{})}),e.jsx("label",{htmlFor:"searchBar",className:"relative w-full",children:e.jsx(Le,{id:"searchBar",className:"h-[60px] text-lg rounded-lg gap-[5px]",placeholder:"관광지, 장소, 숙소,맛집을 검색해 보세요",allowClear:!0,onClear:fe,prefix:e.jsx(ke,{className:"text-slate-400 text-2xl"}),onChange:pe,onPressEnter:t=>ge(t),variant:"filled",value:r})})]}),c?e.jsxs("div",{className:"px-[32px] py-[30px] flex flex-col gap-[30px] min-h-screen",children:[e.jsx("ul",{className:"flex justify-between items-center",children:d.map((t,s)=>e.jsx("li",{className:`cursor-pointer font-semibold text-[16px] w-full flex justify-center items-center px-[15px] py-[10px] gap-[10px] rounded-[8px] ${s===i?"bg-primary text-white":"bg-white text-slate-500"}`,onClick:()=>{C(0),P(s),x({...o,category:s})},children:t.name},s))}),i!==0&&e.jsx("ul",{className:"flex items-center",children:z.map((t,s)=>e.jsx("li",{className:`cursor-pointer font-semibold text-[13px] flex items-center px-3 py-1  ${s===S?"text-primary":"text-slate-500"}`,onClick:()=>{Q(s),C(0)},children:t.name},s))}),i===2&&e.jsxs(T,{form:g,onFinish:je,children:[e.jsx(T.Item,{name:"amenities",className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-slate-50 cursor-pointer",children:e.jsx(H.Group,{className:"flex flex-wrap gap-2",children:Re.map((t,s)=>e.jsx(H,{value:t.amenity_id,children:e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("span",{className:"text-[16px] text-slate-500",children:t.icon}),e.jsx("span",{className:"text-[14px] text-slate-700",children:t.key})]})},s))})}),e.jsx(T.Item,{children:e.jsx(Fe,{type:"primary",htmlType:"submit",children:"적용"})})]}),ee?(l==null?void 0:l.length)===0?e.jsxs("div",{className:"flex flex-col gap-[20px] items-center py-[100px]",children:[e.jsx("i",{className:"text-slate-300 text-[100px]",children:e.jsx(_e,{})}),e.jsx("p",{className:"text-slate-400 text-[20px]",children:"검색 결과가 없습니다."})]}):e.jsxs(e.Fragment,{children:[i===0&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx(m,{title:d[1].name,categoryData:oe,searchValue:r,buttonClick:()=>{$(1)}}),e.jsx(m,{title:d[2].name,categoryData:ne,searchValue:r,buttonClick:()=>{$(2)}}),e.jsx(m,{title:d[3].name,categoryData:ie,searchValue:r,buttonClick:()=>{$(3)}}),e.jsx(m,{title:d[4].name,categoryData:xe,searchValue:r,buttonClick:()=>{$(4)}})]}),i===1&&e.jsx(m,{title:d[1].name,categoryData:l,searchValue:r,buttonClick:A,showMore:R}),i===2&&e.jsx(m,{title:d[2].name,categoryData:l,searchValue:r,buttonClick:A,showMore:R}),i===3&&e.jsx(m,{title:d[3].name,categoryData:l,searchValue:r,buttonClick:A,showMore:R}),i===4&&e.jsx(m,{title:d[4].name,categoryData:l,searchValue:r,buttonClick:A,showMore:R})]}):e.jsx("div",{className:"flex justify-center items-center h-[50vh]",children:e.jsx(we,{color:"#0DD1FD",speedMultiplier:.8})})]}):e.jsxs("div",{className:"px-[32px] flex flex-col gap-[50px]",children:[h&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"최근 검색어"}),e.jsx("ul",{className:"flex gap-[20px] flex-wrap",children:w?w==null?void 0:w.map((t,s)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",onClick:()=>de(t),children:t.txt},s)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"인기 검색어"}),e.jsx("ul",{className:"flex gap-[20px] flex-wrap",children:v?v==null?void 0:v.map((t,s)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",onClick:()=>me(t),children:t.strfName},s)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),h&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"최근 본 목록"}),e.jsx("button",{type:"button",className:"text-slate-400 text-[18px]",onClick:()=>L(!0),children:"모두 삭제"})]}),e.jsx("ul",{className:"flex flex-col gap-[20px]",children:k?k==null?void 0:k.map((t,s)=>e.jsxs("li",{className:"flex cursor-pointer items-center justify-between",onClick:()=>he(t),children:[e.jsxs("div",{className:"flex gap-[15px]",children:[e.jsx("div",{className:"w-[80px] h-[80px] rounded-2xl overflow-hidden",children:e.jsx("img",{className:"w-full h-full object-cover",src:t.strfPic?`${K}${t.strfId}/${t.strfPic}`:"/images/logo_icon_4.png",alt:t.strfName})}),e.jsxs("div",{className:"flex flex-col gap-[5px] justify-center",children:[e.jsx("div",{className:"text-[18px] text-slate-700 font-semibold",children:t.strfName}),e.jsxs("div",{className:"flex gap-[5px]",children:[e.jsx("span",{className:"text-slate-500 text-[14px]",children:X(t.category)}),e.jsx("span",{className:"text-slate-500 text-[14px]",children:"•"}),e.jsx("span",{className:"text-slate-500 text-[14px]",children:t.locationTitle})]})]})]}),e.jsx("button",{type:"button",className:"text-slate-400 text-[20px]",onClick:()=>le(t),children:e.jsx(Se,{})})]},s)):null})]})]}),Z&&e.jsx(Ie,{handleClickCancle:ue,handleClickSubmit:re,content:"최근 본 목록을 모두 삭제하시겠습니까?"})]})};export{xt as default};

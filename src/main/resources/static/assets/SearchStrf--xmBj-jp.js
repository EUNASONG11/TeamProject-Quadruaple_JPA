import{u as H,j as e,R as ge,E as je,r as s,g as O,b as g,e as V,h as ye,d as Ne,F as be,B as Ce,P as ve}from"./index-BGHWUDxE.js";import{a as ke}from"./index-B3MVPx6P.js";import{C as we}from"./CenterModal-Bwcebn_c.js";import{a as Y}from"./pic-Jp7D6aQ0.js";import{c as G,a as Se}from"./match-ChMYlwL3.js";import{A as Ie,a as Re}from"./index-TRUt1gSr.js";import{R as De}from"./index-D6EqS_VH.js";import{L as Te}from"./index-DeoNTO6Q.js";import{F as R}from"./index-O6ZiyhXz.js";import{C as U}from"./index-7Qlcqcx6.js";import"./index-vlq03QuG.js";import"./index-CTbG2f79.js";import"./index-BsKwfqEZ.js";import"./index-CudnfwEk.js";import"./Portal-DfUe9zXX.js";import"./useId-CTpNyTuI.js";import"./zoom-DN100uF_.js";import"./collapse-BbEVqHco.js";import"./index-BzrfdK0U.js";import"./useLocale-RIVdimBb.js";import"./Checkbox-BL-AUIg7.js";const Ae=u=>{u.current.scrollIntoView({behavior:"smooth"})},d=({showMore:u=!0,title:c,categoryData:x,searchValue:h,buttonClick:j})=>{const f=H(),D=l=>{f(`/contents/index?strfId=${l.strfId}`)};return e.jsxs("div",{className:"flex flex-col gap-[20px] items-center",children:[e.jsx("h2",{className:"w-full text-[24px] font-semibold text-slate-700",children:c}),e.jsx("ul",{className:"w-full flex flex-col gap-[20px] mb-[30px]",children:x==null?void 0:x.map((l,y)=>e.jsxs("li",{className:"flex gap-[20px] items-center cursor-pointer",onClick:()=>{D(l)},children:[e.jsx("div",{className:"w-[130px] h-[130px] bg-slate-200 rounded-[8px] overflow-hidden",children:e.jsx("img",{src:`${Y}${l.strfId}/${l.strfPic}`,alt:l.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-[5px]",children:[e.jsx("div",{className:"flex gap-[5px] items-center ",children:e.jsx("h3",{className:"text-[20px] font-semibold text-slate-700",children:l.title||l.strfTitle})}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("p",{className:"text-[14px] text-slate-500",children:G(l.category)}),e.jsx("p",{className:"text-[14px] text-slate-500",children:"|"}),e.jsx("p",{className:"text-[14px] text-slate-500",children:l.locationName})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx(De,{disabled:!0,count:1,value:l.hasMyReview!==0?1:0}),e.jsx("p",{className:"text-[12px] text-slate-500",children:l.averageRating?l.averageRating:"0"}),e.jsxs("p",{className:"text-[12px] text-slate-500",children:["(",l.reviewCount.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("div",{children:l.wishIn?e.jsx(Ie,{className:"text-secondary3"}):e.jsx(Re,{className:"text-slate-400"})}),e.jsx("p",{className:"text-[12px] text-slate-500",children:l.wishlistCount.toLocaleString()})]})]})]},y))}),u&&e.jsxs("button",{type:"button",className:`px-[20px] py-[10px] border border-slate-300 \r
\r
        rounded-[24px] text-[16px] font-semibold text-slate-600`,onClick:j,children:[c," 검색결과 더보기"]})]})},p=[{type:"all",name:"전체"},{type:"TOUR",name:"관광지"},{type:"STAY",name:"숙소"},{type:"RESTAUR",name:"맛집"},{type:"FEST",name:"축제"}],z=[{type:"ratingAvg",name:"• 평점순"},{type:"reviewCount",name:"• 리뷰순"},{type:"likeCount",name:"• 좋아요순"}],et=()=>{var W;const[u]=R.useForm(),[c,x]=ge(je);s.useEffect(()=>{console.log("searchRecoil",c)},[c]);const h=O("accessToken");(W=O("user"))==null||W.userId;const j=s.useRef(null),f=H(),D=()=>{f(-1),x({...c,searchWord:"",searchData:[],lastIndex:0})},[l,y]=s.useState(c.searchWord!==""),[r,T]=s.useState(c.searchWord||""),[o,A]=s.useState(c.searchData||[]),[M,N]=s.useState(c.lastIndex||0),[b,K]=s.useState([]),[C,q]=s.useState([]),[v,J]=s.useState([]),[i,_]=s.useState(c.category||0),[k,Q]=s.useState(0),[X,$]=s.useState(!1),[Z,L]=s.useState(!1),[w,P]=s.useState(!0),[$e,ee]=s.useState([]),te=s.useCallback(async()=>{const t="/api/search/popular";try{const a=await g.get(t);K(a.data.data)}catch(a){console.log("인기 검색어",a)}},[]),E=s.useCallback(async()=>{try{const a=(await V.get("/api/search/basic")).data;q(a.data)}catch(t){console.log("최근 본 검색 결과",t)}},[]),se=s.useCallback(async()=>{try{const n=(await V.get("/api/search/list")).data.data.filter(m=>m.txt!=="");J(n)}catch(t){console.log("최근 검색어 호출 결과:",t)}},[]),ae=s.useCallback(async t=>{const a={strf_id:t.strfId};try{const n=await g.patch(`/api/recent/hide?strf_id=${t.strfId}`,{...a},{headers:{Authorization:`Bearer ${h}`}});console.log(n.data),n.data&&E()}catch(n){console.log("개별 삭제",n)}},[]),le=s.useCallback(async()=>{try{const t=await g.patch("/api/recent/hide/all",{},{headers:{Authorization:`Bearer ${h}`}});console.log(t.data),t.data&&(E(),$(!1))}catch(t){console.log("개별 삭제",t)}},[]),F=s.useCallback(async t=>{const a={search_word:t};console.log("전체 검색",a);try{const m=(await g.post(`/api/search/all?search_word=${t}`,a)).data;m&&(L(!0),y(!0)),A(m.data)}catch(n){console.log("전체 검색",n)}},[]),B=s.useCallback(async()=>{try{const t=M,n=(await g.get(`/api/search/category?last_index=${t}&category=${p[i].name}&search_word=${r}&order_type=${z[k].type}`)).data;n&&L(!0),n.data&&n.data.length>0?(A(m=>t===0?n.data:[...m,...n.data]),N(t+10)):P(!1)}catch(t){console.log("카테고리 검색",t)}},[i,M,r,k]),re=o.filter(t=>t.category==="TOUR"),ce=o.filter(t=>t.category==="STAY"),ne=o.filter(t=>t.category==="RESTAUR"),oe=o.filter(t=>t.category==="FEST"),ie=t=>{T(t.target.value)},xe=s.useCallback(t=>{console.log("클릭한 최근 검색어:",t),T(t.txt),F(t.txt)},[]),pe=s.useCallback(t=>{console.log("클릭한 인기 검색어:",t),f(`/contents/index?strfId=${t.strfId}`)},[]),de=s.useCallback(t=>{console.log("클릭한 최근 본 목록:",t),f(`/contents/index?strfId=${t.strfId}`)},[]),he=s.useCallback(()=>{T("")},[]),me=()=>{$(!1)},ue=t=>{r.trim()&&(L(!1),F(t.target.value),x({...c,searchWord:r}),y(!0))},S=t=>{Ae(j),_(t),x({...c,category:t})},I=()=>{B()},fe=t=>{console.log("values",t.amenities),ee(t.amenities)};return s.useEffect(()=>{te(),h&&(E(),se())},[]),s.useEffect(()=>{r!==""&&x({...c,searchWord:r})},[r]),s.useEffect(()=>{if(N(0),A([]),P(!0),x(t=>({...t,lastIndex:0,searchData:[]})),r.trim()){const t=setTimeout(()=>{i!==0?B():F(r)},100);return()=>clearTimeout(t)}},[i,k]),s.useEffect(()=>{o.length>0&&x({...c,searchData:o})},[o]),e.jsxs("div",{className:"w-full flex flex-col gap-[30px] mb-[100px]",children:[e.jsxs("div",{className:"w-full px-[32px] py-[30px] flex items-center gap-[40px] relative",ref:j,children:[e.jsx("div",{className:"text-[36px] cursor-pointer",onClick:()=>{D()},children:e.jsx(ye,{})}),e.jsx("label",{htmlFor:"searchBar",className:"relative w-full",children:e.jsx(Ne,{id:"searchBar",className:"h-[60px] text-lg rounded-lg gap-[5px]",placeholder:"관광지, 장소, 숙소,맛집을 검색해 보세요",allowClear:!0,onClear:he,prefix:e.jsx(be,{className:"text-slate-400 text-2xl"}),onChange:ie,onPressEnter:t=>ue(t),variant:"filled",value:r})})]}),l?e.jsxs("div",{className:"px-[32px] py-[30px] flex flex-col gap-[30px] min-h-screen",children:[e.jsx("ul",{className:"flex justify-between items-center",children:p.map((t,a)=>e.jsx("li",{className:`cursor-pointer font-semibold text-[16px] w-full flex justify-center items-center px-[15px] py-[10px] gap-[10px] rounded-[8px] ${a===i?"bg-primary text-white":"bg-white text-slate-500"}`,onClick:()=>{N(0),_(a),x({...c,category:a})},children:t.name},a))}),i!==0&&e.jsx("ul",{className:"flex items-center",children:z.map((t,a)=>e.jsx("li",{className:`cursor-pointer font-semibold text-[13px] flex items-center px-3 py-1  ${a===k?"text-primary":"text-slate-500"}`,onClick:()=>{Q(a),N(0)},children:t.name},a))}),i===2&&e.jsxs(R,{form:u,onFinish:fe,children:[e.jsx(R.Item,{name:"amenities",className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-slate-50 cursor-pointer",children:e.jsx(U.Group,{className:"flex flex-wrap gap-2",children:Se.map((t,a)=>e.jsx(U,{value:t.amenity_id,children:e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("span",{className:"text-[16px] text-slate-500",children:t.icon}),e.jsx("span",{className:"text-[14px] text-slate-700",children:t.key})]})},a))})}),e.jsx(R.Item,{children:e.jsx(Ce,{type:"primary",htmlType:"submit",children:"적용"})})]}),Z?o.length===0?e.jsxs("div",{className:"flex flex-col gap-[20px] items-center py-[100px]",children:[e.jsx("i",{className:"text-slate-300 text-[100px]",children:e.jsx(Te,{})}),e.jsx("p",{className:"text-slate-400 text-[20px]",children:"검색 결과가 없습니다."})]}):e.jsxs(e.Fragment,{children:[i===0&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx(d,{title:p[1].name,categoryData:re,searchValue:r,buttonClick:()=>{S(1)}}),e.jsx(d,{title:p[2].name,categoryData:ce,searchValue:r,buttonClick:()=>{S(2)}}),e.jsx(d,{title:p[3].name,categoryData:ne,searchValue:r,buttonClick:()=>{S(3)}}),e.jsx(d,{title:p[4].name,categoryData:oe,searchValue:r,buttonClick:()=>{S(4)}})]}),i===1&&e.jsx(d,{title:p[1].name,categoryData:o,searchValue:r,buttonClick:I,showMore:w}),i===2&&e.jsx(d,{title:p[2].name,categoryData:o,searchValue:r,buttonClick:I,showMore:w}),i===3&&e.jsx(d,{title:p[3].name,categoryData:o,searchValue:r,buttonClick:I,showMore:w}),i===4&&e.jsx(d,{title:p[4].name,categoryData:o,searchValue:r,buttonClick:I,showMore:w})]}):e.jsx("div",{className:"flex justify-center items-center h-[50vh]",children:e.jsx(ve,{color:"#0DD1FD",speedMultiplier:.8})})]}):e.jsxs("div",{className:"px-[32px] flex flex-col gap-[50px]",children:[h&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"최근 검색어"}),e.jsx("ul",{className:"flex gap-[20px] flex-wrap",children:v?v==null?void 0:v.map((t,a)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",onClick:()=>xe(t),children:t.txt},a)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"인기 검색어"}),e.jsx("ul",{className:"flex gap-[20px] flex-wrap",children:b?b==null?void 0:b.map((t,a)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",onClick:()=>pe(t),children:t.strfName},a)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),h&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"최근 본 목록"}),e.jsx("button",{type:"button",className:"text-slate-400 text-[18px]",onClick:()=>$(!0),children:"모두 삭제"})]}),e.jsx("ul",{className:"flex flex-col gap-[20px]",children:C?C==null?void 0:C.map((t,a)=>e.jsxs("li",{className:"flex cursor-pointer items-center justify-between",onClick:()=>de(t),children:[e.jsxs("div",{className:"flex gap-[15px]",children:[e.jsx("div",{className:"w-[80px] h-[80px] rounded-2xl overflow-hidden",children:e.jsx("img",{className:"w-full h-full object-cover",src:t.strfPic?`${Y}${t.strfId}/${t.strfPic}`:"/images/logo_icon_4.png",alt:t.strfName})}),e.jsxs("div",{className:"flex flex-col gap-[5px] justify-center",children:[e.jsx("div",{className:"text-[18px] text-slate-700 font-semibold",children:t.strfName}),e.jsxs("div",{className:"flex gap-[5px]",children:[e.jsx("span",{className:"text-slate-500 text-[14px]",children:G(t.category)}),e.jsx("span",{className:"text-slate-500 text-[14px]",children:"•"}),e.jsx("span",{className:"text-slate-500 text-[14px]",children:t.locationTitle})]})]})]}),e.jsx("button",{type:"button",className:"text-slate-400 text-[20px]",onClick:()=>ae(t),children:e.jsx(ke,{})})]},a)):null})]})]}),X&&e.jsx(we,{handleClickCancle:me,handleClickSubmit:le,content:"최근 본 목록을 모두 삭제하시겠습니까?"})]})};export{et as default};

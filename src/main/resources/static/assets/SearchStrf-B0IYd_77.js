import{G as ye,u as H,j as e,a2 as U,a3 as je,a4 as Ce,k as Z,r as l,m as g,B as _,R as Ne,g as V,Z as be,l as ve,P as we}from"./index-LV_9s5-1.js";import{F as ke}from"./index-DdrXLXVe.js";import{j as T}from"./jwt-Cwbp2SV6.js";import{s as z}from"./searchAtom-DskBk_2_.js";import"./userAtom-Bt2xL0hP.js";import{C as Se}from"./CenterModal-DOh-j6Y9.js";import{d as G,e as De}from"./match-5XfzEgGS.js";import{R as Ie}from"./index-BsJ66pFJ.js";import{L as Te}from"./index-CdvDs16G.js";import{m as _e}from"./moveTo-C0ahqY7n.js";import{T as Re}from"./TitleHeader-6cQeiO5x.js";import{b as $e}from"./index-D6sixpAC.js";import{F as q}from"./index-lMOVuc5h.js";import{r as We}from"./searchSelector-W9W1vIh0.js";import{S as M,a as O}from"./swiper-react-Ck51p-jd.js";import{S as Ae}from"./index-zIh89b6u.js";import"./index-CoXfSCcE.js";import"./index-ChJ6LYmi.js";import"./index-DXJ_gz2Q.js";import"./index-C_ByFtLp.js";import"./index-DN57V0sg.js";import"./index-Btv3waz5.js";import"./Portal-CiuFLH_K.js";import"./useId-LGEjO-HJ.js";import"./motion-D8x5Mwwf.js";import"./roundedArrow-D1YheW33.js";import"./zoom-Bx4l_5D1.js";import"./index-Ds3yrZWO.js";import"./index-CF7lad59.js";import"./responsiveObserver-9NKrBLMQ.js";import"./index-DUIhxVpy.js";import"./useLocale-opc6SEmi.js";import"./Overflow-DLIyATPg.js";import"./PurePanel-n0ncbYSz.js";import"./useIcons-Dz7aEj4z.js";import"./CheckOutlined-CVzJC9Pt.js";const d=[{type:null,name:"전체"},{type:"TOUR",name:"관광지"},{type:"STAY",name:"숙소"},{type:"RESTAUR",name:"맛집"},{type:"FEST",name:"축제"}],R=[{type:"ratingAvg",name:"평점순"},{type:"ratingCnt",name:"리뷰순"},{type:"likeCnt",name:"좋아요순"}];function Le(t){return ye({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M6 9.5C6.93191 9.5 7.71496 10.1374 7.93699 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7455 13.8231 11.9496 13.5899 11.9919L13.5 12L7.93673 12.001C7.71435 12.8631 6.93155 13.5 6 13.5C5.06845 13.5 4.28565 12.8631 4.06327 12.001L2.5 12C2.22386 12 2 11.7761 2 11.5C2 11.2545 2.17688 11.0504 2.41012 11.0081L2.5 11H4.06301C4.28504 10.1374 5.06809 9.5 6 9.5ZM6 10.5C5.44772 10.5 5 10.9477 5 11.5C5 12.0523 5.44772 12.5 6 12.5C6.55228 12.5 7 12.0523 7 11.5C7 10.9477 6.55228 10.5 6 10.5ZM10 2.5C10.9319 2.5 11.715 3.13738 11.937 3.99998L13.5 4C13.7761 4 14 4.22386 14 4.5C14 4.74546 13.8231 4.94961 13.5899 4.99194L13.5 5L11.9367 5.00102C11.7144 5.86312 10.9316 6.5 10 6.5C9.06845 6.5 8.28565 5.86312 8.06327 5.00102L2.5 5C2.22386 5 2 4.77614 2 4.5C2 4.25454 2.17688 4.05039 2.41012 4.00806L2.5 4L8.06301 3.99998C8.28504 3.13738 9.06809 2.5 10 2.5ZM10 3.5C9.44772 3.5 9 3.94772 9 4.5C9 5.05228 9.44772 5.5 10 5.5C10.5523 5.5 11 5.05228 11 4.5C11 3.94772 10.5523 3.5 10 3.5Z"},child:[]}]})(t)}const f=({showMore:t=!0,title:r,categoryData:x,searchValue:h,buttonClick:C})=>{const m=H(),y=n=>{m(`/contents/index?strfId=${n.strfId}`)};return e.jsxs("div",{className:"flex flex-col gap-[20px] items-center",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:r}),e.jsx("ul",{className:"w-full flex flex-col gap-[20px] mb-[30px]",children:x==null?void 0:x.map((n,N)=>{var c,o;return e.jsxs("li",{className:"flex gap-3 items-start cursor-pointer",onClick:()=>{y(n)},children:[e.jsx("div",{className:"aspect-square w-[26.67vw] max-w-[200px] bg-slate-200 rounded-[8px] overflow-hidden",children:e.jsx("img",{src:`${U}/${n.strfId}/${n.strfPic}`,alt:n.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("div",{className:"flex gap-[5px] items-center ",children:e.jsx("h3",{className:"text-xs font-semibold text-slate-700",children:n.title||n.strfTitle})}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("p",{className:"text-xs text-slate-500",children:G(n.category)}),e.jsx("p",{className:"text-xs text-slate-500",children:"|"}),e.jsx("p",{className:"text-xs text-slate-500",children:n.locationName})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx(Ie,{disabled:!0,count:1,value:n.hasMyReview!==0?1:0,className:"text-xs"}),e.jsx("p",{className:"text-xs text-slate-500",children:n.averageRating?n.averageRating:n.ratingAvg?n.ratingAvg:"0"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["(",(c=n.reviewCount)==null?void 0:c.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("div",{children:n.wishIn?e.jsx(je,{className:"text-secondary3 text-xs"}):e.jsx(Ce,{className:"text-slate-400 text-xs"})}),e.jsx("p",{className:"text-xs text-slate-500",children:(o=n.wishlistCount)==null?void 0:o.toLocaleString()})]})]})]},N)})}),t&&e.jsxs("button",{type:"button",className:`px-[20px] py-[10px] border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:C,children:[r," 검색결과 더보기"]})]})},Fe=({setIsAmenityOpen:t})=>{q.useForm();const[r,x]=Z(z);l.useEffect(()=>{console.log("선택된 필터",r.amenityId)},[r.amenityId]);const h=l.useCallback(async()=>{const c=r.amenityId.map(o=>`amenity_id=${o.amenity_id}`).join("&");try{const o=await g.get(`/api/search/filter?start_idx=0&category=숙소&search_word=${r.searchWord}&${c}`);console.log("편의시설",o.data);const j=o.data;j.data.more===!1&&x(p=>({...p,more:!1})),x(p=>({...p,searchData:j.data}))}catch(o){console.log("편의시설",o)}},[]),C=()=>{t(!1),x(c=>({...c,amenityId:[]}))},m=()=>{x(c=>({...c,amenityId:[]}))},y=c=>{x(o=>({...o,orderType:c}))},n=c=>{r.amenityId.includes(c)?x({...r,amenityId:r.amenityId.filter(o=>o!==c)}):x({...r,amenityId:[...r.amenityId,c]})},N=()=>{console.log("handleSubmit",r),t(!1),h()};return e.jsx("div",{className:`fixed top-0 left-[50%] translate-x-[-50%] z-10\r
            max-w-[768px] w-full mx-auto h-screen\r
            bg-white`,children:e.jsxs("div",{className:"relative h-full",children:[e.jsx(Re,{title:"필터",onClick:C}),e.jsxs("section",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"px-4 py-6",children:[e.jsx("h4",{className:"py-2 text-base font-semibold text-slate-700",children:"정렬"}),e.jsx("ul",{children:R.map((c,o)=>e.jsx("li",{className:"py-3 border-b border-slate-100",onClick:()=>y(o),children:e.jsx("button",{className:`text-sm  hover:text-primary transition-all duration-75
                      ${r.orderType===o?"text-primary":"text-slate-700"}`,children:c.name})},o))})]}),e.jsxs("div",{className:"px-4 py-6 flex flex-col gap-3",children:[e.jsx("h4",{className:"text-base font-semibold text-slate-700",children:"편의시설"}),e.jsx("ul",{className:"flex flex-wrap gap-[6px]",children:De.map((c,o)=>{var j;return e.jsx("li",{onClick:()=>n(c),className:`w-fit px-3 py-[6px] rounded-lg border text-sm select-none cursor-pointer ${(j=r.amenityId)!=null&&j.includes(c)?"text-primary border-primary":"text-slate-500 border-slate-200"}`,children:c.key},o)})})]})]}),e.jsxs("section",{className:` absolute bottom-0 left-0 right-0 bg-white\r
      flex items-center gap-3 px-4 py-4 border-t border-slate-100`,children:[e.jsxs(_,{className:"px-[14px] py-3 !h-auto text-base text-slate-500",onClick:m,children:[e.jsx($e,{className:"text-slate-300"}),"초기화"]}),e.jsx(_,{type:"primary",className:"w-full px-[14px] py-3 !h-auto text-base",onClick:N,children:"적용하기"})]})]})})},ja=()=>{var A,L,F,B,E,P;q.useForm();const[t,r]=Z(z),x=Ne(We);l.useEffect(()=>{console.log("searchRecoil",t)},[t]);const h=V("accessToken");(A=V("user"))==null||A.userId;const C=l.useRef(null),m=l.useRef(null),y=H(),n=()=>{y(-1),x()},[N,c]=l.useState(t.searchWord!==""),[o,j]=l.useState([]),[p,Y]=l.useState([]),[v,K]=l.useState([]),[J,S]=l.useState(!1),[Q,b]=l.useState(!1),[X,$]=l.useState(!1);l.useState(0);const ee=l.useCallback(async()=>{const a="/api/search/popular";try{const s=await g.get(a);j(s.data.data)}catch(s){console.log("인기 검색어",s)}},[]),D=l.useCallback(async()=>{try{const s=(await T.get("/api/search/basic")).data;Y(s.data)}catch(a){console.log("최근 본 검색 결과",a)}},[]),ae=l.useCallback(async()=>{try{const i=(await T.get("/api/search/list")).data.data.filter(u=>u.txt!=="");K(i)}catch(a){console.log("최근 검색어 호출 결과:",a)}},[]);l.useCallback(async a=>{const s={strf_id:a.strfId};try{const i=await g.patch(`/api/recent/hide?strf_id=${a.strfId}`,{...s},{headers:{Authorization:`Bearer ${h}`}});console.log(i.data),i.data&&D()}catch(i){console.log("개별 삭제",i)}},[]);const te=l.useCallback(async()=>{try{const a=await g.patch("/api/recent/hide/all",{},{headers:{Authorization:`Bearer ${h}`}});console.log(a.data),a.data&&(D(),S(!1))}catch(a){console.log("개별 삭제",a)}},[]),I=l.useCallback(async a=>{if(h)try{const i=(await T.get(`/api/search/all?search_word=${a}`)).data;i&&(b(!0),c(!0)),r(u=>({...u,searchData:i.data,start_idx:0,category:0,amenityId:[],orderType:0,more:!0}))}catch(s){console.log("전체 검색",s)}else try{const i=(await g.get(`/api/search/all?search_word=${a}`)).data;i&&(b(!0),c(!0)),r(u=>({...u,searchData:i.data}))}catch(s){console.log("전체 검색",s)}},[]),W=l.useCallback(async()=>{try{const s=(await g.get(`/api/search/category?start_idx=${t.start_idx}&category=${d[t.category].name}&search_word=${t.searchWord}&order_type=${R[t.orderType].type}`)).data;s&&b(!0),s.data&&s.data.length>=10?r(i=>{var u;return{...i,searchData:t.start_idx===0?s.data:[...i.searchData,...s.data],start_idx:t.start_idx+10,more:(u=s.data[0])==null?void 0:u.more}}):r(i=>({...i,searchData:t.start_idx===0?s.data:[...i.searchData,...s.data],start_idx:t.start_idx+s.data.length+1,more:!1}))}catch(a){console.log("카테고리 검색",a)}},[t.category,t.start_idx,t.searchWord,t.orderType]),se=l.useCallback(async()=>{try{const a=await g.get(`/api/search/count?category=${d[t.category].name}&search_word=${t.searchWord}`);console.log("검색 총 수",a.data),r(s=>({...s,count:a.data.data}))}catch(a){console.log("검색 총 수",a)}},[t.category,t.searchWord]);l.useCallback(async()=>{const a=t.amenityId.map(s=>`amenity_id=${s.amenity_id}`).join("&");try{const s=await g.get(`/api/search/count?category=${d[t.category].name}&search_word=${t.searchWord}&${a}`);console.log("편의필터 검색 총 수",s.data),r(i=>({...i,count:s.data.data}))}catch(s){console.log("편의필터 검색 총 수",s)}},[t.amenityId,t.searchWord]),l.useEffect(()=>{se()},[t.category,t.searchWord]);const re=(L=t.searchData)==null?void 0:L.filter(a=>a.category==="TOUR"),le=(F=t.searchData)==null?void 0:F.filter(a=>a.category==="STAY"),ce=(B=t.searchData)==null?void 0:B.filter(a=>a.category==="RESTAUR"),oe=(E=t.searchData)==null?void 0:E.filter(a=>a.category==="FEST"),ne=a=>{r(s=>({...s,searchWord:a.target.value}))},ie=l.useCallback(a=>{console.log("클릭한 최근 검색어:",a),r(s=>({...s,searchWord:a.txt})),I(a.txt)},[]),xe=l.useCallback(a=>{console.log("클릭한 인기 검색어:",a),y(`/contents/index?strfId=${a.strfId}`)},[]),de=l.useCallback(a=>{console.log("클릭한 최근 본 목록:",a),y(`/contents/index?strfId=${a.strfId}`)},[]),he=l.useCallback(()=>{r(a=>({...a,searchWord:""}))},[]),me=()=>{S(!1)},pe=a=>{t.searchWord.trim()&&(b(!1),I(a.target.value),c(!0))},w=a=>{_e(C),setSelectedCategory(a),r(s=>({...s,category:a}))},ue=a=>{r(s=>({...s,start_idx:0,category:a,orderType:0})),m.current&&m.current.swiper&&m.current.swiper.slideTo(a)},k=()=>{W()},fe=()=>{$(!0)};l.useEffect(()=>{ee(),h&&(D(),ae())},[]),l.useEffect(()=>{if(r(a=>({...a,searchData:[],start_idx:0,more:!0})),b(!1),t.searchWord.trim()){const a=setTimeout(()=>{t.category!==0?W():I(t.searchWord)},100);return()=>clearTimeout(a)}},[t.category,t.orderType]);const ge=a=>{r(s=>({...s,orderType:a,start_idx:0}))};return e.jsxs("div",{className:"w-full flex flex-col  mb-[100px]",children:[e.jsxs("div",{className:"w-full px-4 py-6 flex items-center gap-3 relative",ref:C,children:[e.jsx("div",{className:"text-3xl cursor-pointer",onClick:()=>{n()},children:e.jsx(be,{})}),e.jsx("label",{htmlFor:"searchBar",className:"relative w-full",children:e.jsx(ve,{id:"searchBar",placeholder:"관광지, 장소, 숙소,맛집을 검색해 보세요",allowClear:!0,onClear:he,suffix:e.jsx(ke,{className:"text-slate-400 text-2xl"}),onChange:ne,onPressEnter:a=>{a.target.value.trim()&&pe(a)},variant:"filled",value:t.searchWord,className:`max-h-[60px] h-[16vw] text-lg rounded-lg gap-[5px]\r
            bg-slate-50 hover:bg-slate-100 placeholder:text-slate-400 `})})]}),N?e.jsxs("div",{className:"px-[32px] py-[30px] flex flex-col min-h-screen",children:[e.jsx("div",{className:"py-4",children:e.jsx(M,{ref:m,slidesPerView:4.5,spaceBetween:6,initialSlide:t.category,children:d.map((a,s)=>e.jsx(O,{className:`cursor-pointer text-sm w-full flex justify-center items-center py-2 gap-[10px] rounded-xl ${s===t.category?"bg-primary text-white":"bg-white text-slate-500"}`,onClick:()=>{ue(s)},children:e.jsxs("p",{className:"text-center",children:[" ",a.name]})},s))})}),e.jsx("div",{className:"h-[2.66vw] max-h-[10px] bg-slate-100"}),e.jsxs("div",{className:"flex items-center gap-3 justify-between py-4",children:[e.jsx("div",{className:"text-xs text-slate-700 font-semibold",children:t.category===0?null:`총 ${t.count}개`}),e.jsxs("div",{className:"flex items-center gap-3",children:[t.category!==0&&e.jsx(Ae,{value:t.orderType,onChange:ge,options:R.map((a,s)=>({value:s,label:e.jsx("span",{className:"text-slate-500 text-xs",children:a.name})})),style:{color:"#64748b"},className:"h-[4.53vw] max-h-[17px]",variant:"borderless"}),e.jsx("div",{children:t.category===2&&e.jsxs(_,{onClick:fe,type:"button",className:"text-xs text-slate-500",children:["필터 ",e.jsx(Le,{})]})})]})]}),Q?((P=t.searchData)==null?void 0:P.length)===0?e.jsxs("div",{className:"flex flex-col gap-[20px] items-center py-[100px]",children:[e.jsx("i",{className:"text-slate-300 text-[100px]",children:e.jsx(Te,{})}),e.jsx("p",{className:"text-slate-400 text-[20px]",children:"검색 결과가 없습니다."})]}):e.jsxs(e.Fragment,{children:[t.category===0&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx(f,{title:d[1].name,categoryData:re,searchValue:t.searchWord,buttonClick:()=>{w(1)}}),e.jsx(f,{title:d[2].name,categoryData:le,searchValue:t.searchWord,buttonClick:()=>{w(2)}}),e.jsx(f,{title:d[3].name,categoryData:ce,searchValue:t.searchWord,buttonClick:()=>{w(3)}}),e.jsx(f,{title:d[4].name,categoryData:oe,searchValue:t.searchWord,buttonClick:()=>{w(4)}})]}),t.category===1&&e.jsx(f,{title:d[1].name,categoryData:t.searchData,searchValue:t.searchWord,buttonClick:k}),t.category===2&&e.jsx(f,{title:d[2].name,categoryData:t.searchData,searchValue:t.searchWord,buttonClick:k}),t.category===3&&e.jsx(f,{title:d[3].name,categoryData:t.searchData,searchValue:t.searchWord,buttonClick:k}),t.category===4&&e.jsx(f,{title:d[4].name,categoryData:t.searchData,searchValue:t.searchWord,buttonClick:k})]}):e.jsx("div",{className:"flex justify-center items-center h-[50vh]",children:e.jsx(we,{color:"#0DD1FD",speedMultiplier:.8})})]}):e.jsxs("div",{className:"flex flex-col gap-8 px-4",children:[h&&e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-700 select-none",children:"최근 검색어"}),e.jsx("ul",{className:"flex gap-3 flex-wrap",children:v?v==null?void 0:v.map((a,s)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-4 py-[6px] rounded-[20px] text-sm select-none",onClick:()=>ie(a),children:a.txt},s)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-lg  font-semibold text-slate-700 select-none",children:"인기 검색어"}),e.jsx("ul",{className:"flex flex-col gap-[20px] flex-wrap h-[40vw] max-h-[250px]",children:o?o==null?void 0:o.map((a,s)=>e.jsx("li",{className:"cursor-pointer ",onClick:()=>xe(a),children:e.jsxs("p",{className:"flex gap-3 items-center select-none",children:[e.jsx("span",{className:"text-slate-700 text-sm font-semibold",children:s+1}),e.jsx("span",{className:"text-slate-700 text-sm",children:a.strfName})]})},s)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),h&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg  font-semibold text-slate-700 select-none",children:"최근 본 상품"}),e.jsx("button",{type:"button",className:"text-slate-400 text-[18px] select-none",onClick:()=>S(!0),children:"모두 삭제"})]}),e.jsx("div",{className:"w-full select-none",children:e.jsx(M,{slidesPerView:2.5,spaceBetween:12,direction:"horizontal",className:"w-full flex select-none",children:p?p==null?void 0:p.map((a,s)=>e.jsx(O,{className:"w-auto !h-auto shrink-0 select-none",onClick:()=>de(a),children:e.jsxs("div",{className:"flex flex-col gap-[15px] w-full select-none",children:[e.jsx("div",{className:"aspect-square w-full rounded-2xl overflow-hidden",children:e.jsx("img",{className:"w-full h-full object-cover",src:a.strfPic?`${U}/${a.strfId}/${a.strfPic}`:"/images/logo_icon_4.png",alt:a.strfName})}),e.jsxs("div",{className:"flex flex-col gap-[5px] justify-center",children:[e.jsx("div",{className:"text-[18px] text-slate-700 font-semibold",children:a.strfName}),e.jsxs("div",{className:"flex gap-[5px]",children:[e.jsx("span",{className:"text-slate-500 text-sm",children:G(a.category)}),e.jsx("span",{className:"text-slate-500 text-sm",children:"•"}),e.jsx("span",{className:"text-slate-500 text-sm",children:a.locationTitle})]})]})]})},s)):null})})]})]}),J&&e.jsx(Se,{handleClickCancle:me,handleClickSubmit:te,content:"최근 본 목록을 모두 삭제하시겠습니까?"}),X&&e.jsx(Fe,{setIsAmenityOpen:$})]})};export{ja as default};

import{g as v,b as S,u as E,a as k,r as n,j as e,I as x,B as A,c as B}from"./index-CXgPt5JN.js";import{M as D}from"./index-ClkmJtaA.js";import"./jwt-68WmjUBv.js";import"./userAtom-DKHhrz4u.js";import{T as U}from"./TitleHeader-CzykBaxH.js";import{R as V}from"./api-RMrr9BxD.js";/* empty css                    */import{F as s}from"./index-03v7AaTi.js";import{R as z}from"./index-2ZNAj9Vd.js";import{U as M}from"./index-DutcZXZ9.js";import{I as $}from"./index-B6bEYUbY.js";import"./dayjs.min-CM77hzp1.js";import"./index-CDNxKOHP.js";import"./index-BIhRtoM_.js";import"./index-BjxdQkl4.js";import"./motion-COLDN99j.js";import"./collapse-BbEVqHco.js";import"./zoom-DXKB7aGh.js";import"./Portal-DyoJ0XAQ.js";import"./responsiveObserver-C8PfZDab.js";import"./index-Cc8zrrM2.js";import"./index-g46somhf.js";import"./index-DVNH3El3.js";import"./useId-CFvmNKkm.js";import"./isMobile-B4CO7CVJ.js";import"./roundedArrow-BJ1xfU1K.js";import"./useLocale-XAzq5U5g.js";import"./fade-DtEfEpc4.js";import"./useForceUpdate-Brh-2j-i.js";import"./CheckOutlined-Bh0Z4Jmq.js";import"./index-rIVHL4Ay.js";import"./addEventListener-DObYpp2P.js";import"./RightOutlined-C0MJpxxt.js";const q=a=>new Promise((m,d)=>{const r=new FileReader;r.readAsDataURL(a),r.onload=()=>m(r.result),r.onerror=l=>d(l)}),Ne=()=>{const a=v("user"),m=v("accessToken");console.log("user",a);const[d]=S(),r=d.get("strfId"),l=E(),u=k().state,[b]=s.useForm(),[o,h]=n.useState([]),[J,y]=n.useState(!1),[F,f]=n.useState(!1),[g,I]=n.useState("");n.useEffect(()=>{console.log("fileList",o)},[o]);const N=async t=>{const{content:C,file:p,rating:T,strfId:L,userId:O}=t,j={userId:parseInt(O),strfId:parseInt(L),rating:parseInt(T),content:C},c=new FormData;p!=null&&p.fileList&&h(p.fileList),c.append("p",new Blob([JSON.stringify(j)],{type:"application/json"})),(o==null?void 0:o.length)>0&&o.forEach(i=>{c.append("pics",i.originFileObj)});const w=c.get("p");w&&w.text().then(i=>console.log("p의 내용:",j));try{(await B.post(`${V.postReview}`,c,{headers:{Authorization:`Bearer ${m}`}})).data.code==="200 성공"&&l(-1)}catch(i){console.error(i)}},P=async t=>{!t.url&&!t.preview&&(t.preview=await q(t.originFileObj)),I(t.url||t.preview),f(!0)},R=({fileList:t})=>h(t);return e.jsxs("div",{children:[e.jsx(U,{icon:"back",onClick:()=>{l(-1)},title:u==null?void 0:u.strfTitle}),e.jsx("div",{className:"px-4",children:e.jsxs(s,{form:b,onFinish:N,layout:"vertical",initialValues:{userId:a.userId,strfId:r},children:[e.jsx(s.Item,{label:"userId",name:"userId",hidden:!0,children:e.jsx(x,{value:a.userId})}),e.jsx(s.Item,{label:"strfId",name:"strfId",hidden:!0,children:e.jsx(x,{value:r})}),e.jsx(s.Item,{name:"rating",className:"flex flex-col justify-center items-center  text-slate-300",help:e.jsx("div",{className:" text-base text-center  text-slate-300 mt-[6px] mb-6",children:"별점을 선택해주세요."}),children:e.jsx(z,{style:{fontSize:"2.25rem"}})}),e.jsx("h3",{className:"mb-2 text-slate-700 text-lg text-center font-semibold",children:"리뷰를 남겨주세요."}),e.jsx(s.Item,{name:"content",rules:[{required:!0,message:"리뷰를 입력해주세요."}],children:e.jsx(x.TextArea,{rows:4,showCount:!0,maxLength:500,placeholder:"직접 경험한 솔직한 리뷰를 남겨주세요.",variant:"borderless",onChange:()=>y(!0),className:`custom-text-area rounded-2xl text-slate-700 placeholder: text-base placeholder: text-slate-400
                `})}),e.jsxs(s.Item,{name:"file",children:[e.jsx(M,{id:"file",listType:"picture-card",beforeUpload:()=>!1,accept:"image/*",fileList:o,onPreview:P,onChange:R,multiple:!0,children:e.jsx(D,{className:"text-4xl text-slate-400"})}),g&&e.jsx($,{wrapperStyle:{display:"none"},preview:{visible:F,onVisibleChange:t=>f(t),afterOpenChange:t=>!t&&I("")},src:g})]}),e.jsx(s.Item,{children:e.jsx(A,{type:"primary",htmlType:"submit",className:`w-full h-[80px] py-[10px] rounded-lg\r
              text-[24px] font-semibold`,children:"완료"})})]})})]})};export{Ne as default};

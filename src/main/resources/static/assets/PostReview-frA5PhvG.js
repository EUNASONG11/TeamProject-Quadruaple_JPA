import{g as b,u as E,a as k,r as l,b as A,j as e,I as x,B,c as D}from"./index-C93OXIGC.js";import{M as U}from"./index-2yaZ5Cyw.js";import"./jwt-B7ax0GDm.js";import"./userAtom-Crr4sDN4.js";import{T as V}from"./TitleHeader-k9V8b0_w.js";import{R as $}from"./api-RMrr9BxD.js";/* empty css                    */import{F as s}from"./index-JWxd_BGD.js";import{R as z}from"./index-CasC0ZUd.js";import{U as M}from"./index-Dtlwg-Ic.js";import{I as q}from"./index-feX_Q_7_.js";import"./dayjs.min-P6fXZY3M.js";import"./index-C-xkmeiy.js";import"./index-BrsyDvBu.js";import"./index-BXh98nWs.js";import"./motion-0KRY6bgR.js";import"./collapse-BbEVqHco.js";import"./zoom-CHy3k0MF.js";import"./Portal-CSn-TfAb.js";import"./responsiveObserver-DAAkn5g5.js";import"./index-CsxvQyL3.js";import"./index-Dngrxowb.js";import"./index-Q7DGeqqa.js";import"./useId-BANbKrPT.js";import"./isMobile-B4CO7CVJ.js";import"./roundedArrow-sw5LZQSn.js";import"./useLocale-OHgcCckO.js";import"./fade-DINDB8as.js";import"./useForceUpdate-DqTnUq-V.js";import"./CheckOutlined-3DJXerys.js";import"./index-DdrkGeri.js";import"./addEventListener-CIFfV5kx.js";import"./RightOutlined-DLO0g29R.js";const H=o=>new Promise((d,c)=>{const a=new FileReader;a.readAsDataURL(o),a.onload=()=>d(a.result),a.onerror=i=>c(i)}),Ne=()=>{const o=b("user"),d=b("accessToken");console.log("user",o);const c=E(),i=k().state,[y]=s.useForm(),[r,u]=l.useState([]),[J,F]=l.useState(!1),[N,h]=l.useState(!1),[f,g]=l.useState(""),[P]=A(),I=P.get("strfId");l.useEffect(()=>{console.log("fileList",r)},[r]);const R=async t=>{const{content:L,file:p,rating:O,strfId:j,userId:S}=t,w={userId:parseInt(S),strfId:parseInt(j),rating:parseInt(O),content:L},m=new FormData;p!=null&&p.fileList&&u(p.fileList),m.append("p",new Blob([JSON.stringify(w)],{type:"application/json"})),(r==null?void 0:r.length)>0&&r.forEach(n=>{m.append("pics",n.originFileObj)});const v=m.get("p");v&&v.text().then(n=>console.log("p의 내용:",w));try{(await D.post(`${$.postReview}`,m,{headers:{Authorization:`Bearer ${d}`}})).data.code==="200 성공"&&c(`/contents/index?strfId=${j}`)}catch(n){console.error(n)}},C=async t=>{!t.url&&!t.preview&&(t.preview=await H(t.originFileObj)),g(t.url||t.preview),h(!0)},T=({fileList:t})=>u(t);return e.jsxs("div",{children:[e.jsx(V,{icon:"back",onClick:()=>{c(-1)},title:i==null?void 0:i.strfTitle}),e.jsx("div",{className:"px-4",children:e.jsxs(s,{form:y,onFinish:R,layout:"vertical",initialValues:{userId:o.userId,strfId:I},children:[e.jsx(s.Item,{label:"userId",name:"userId",hidden:!0,children:e.jsx(x,{value:o.userId})}),e.jsx(s.Item,{label:"strfId",name:"strfId",hidden:!0,children:e.jsx(x,{value:I})}),e.jsx(s.Item,{name:"rating",className:"flex flex-col justify-center items-center  text-slate-300",help:e.jsx("div",{className:" text-base text-center  text-slate-300 mt-[6px] mb-6",children:"별점을 선택해주세요."}),children:e.jsx(z,{style:{fontSize:"2.25rem"}})}),e.jsx("h3",{className:"mb-2 text-slate-700 text-lg text-center font-semibold",children:"리뷰를 남겨주세요."}),e.jsx(s.Item,{name:"content",rules:[{required:!0,message:"리뷰를 입력해주세요."}],children:e.jsx(x.TextArea,{rows:4,showCount:!0,maxLength:500,placeholder:"직접 경험한 솔직한 리뷰를 남겨주세요.",variant:"borderless",onChange:()=>F(!0),className:`custom-text-area rounded-2xl text-slate-700 placeholder: text-base placeholder: text-slate-400
                `})}),e.jsxs(s.Item,{name:"file",children:[e.jsx(M,{id:"file",listType:"picture-card",beforeUpload:()=>!1,accept:"image/*",fileList:r,onPreview:C,onChange:T,multiple:!0,children:e.jsx(U,{className:"text-4xl text-slate-400"})}),f&&e.jsx(q,{wrapperStyle:{display:"none"},preview:{visible:N,onVisibleChange:t=>h(t),afterOpenChange:t=>!t&&g("")},src:f})]}),e.jsx(s.Item,{children:e.jsx(B,{type:"primary",htmlType:"submit",className:`w-full h-[80px] py-[10px] rounded-lg\r
              text-[24px] font-semibold`,children:"완료"})})]})})]})};export{Ne as default};

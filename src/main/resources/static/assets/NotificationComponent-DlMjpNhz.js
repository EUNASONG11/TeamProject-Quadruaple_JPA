import{g as p,r as o,j as n}from"./index-BimvysYt.js";import{e as s}from"./eventsource-Cd5SwtWz.js";const f=({token:c})=>{const a=p("accessToken"),[i,u]=o.useState(!1),l=s.EventSourcePolyfill||s.NativeEventSource,t=o.useRef(null);return o.useEffect(()=>{if(!a)return;const r=()=>{t.current=new l("/api/notice",{headers:{Authorization:`Bearer ${c}`,Connetction:"keep-alive",Accept:"text/event-stream","Cache-Control":"no-cache"},withCredentials:!0}),t.current.onmessage=e=>{console.log("새로운 알림:",e.data)},t.current.addEventListener("exist unread notice",e=>{console.log("안 읽은 알림 존재:",e.data),u(!0)}),t.current.onerror=async()=>{var e;(e=t.current)==null||e.close(),setTimeout(r,36e4)},t.current.onopen=()=>{}};return r(),()=>{var e;(e=t.current)==null||e.close()}},[t]),n.jsx("div",{children:i&&n.jsx("span",{className:"absolute top-[1px] right-[1px] w-[6px] h-[6px] bg-secondary3 border-2 border-white box-content rounded-full"})})};export{f as N};

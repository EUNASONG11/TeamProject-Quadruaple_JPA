import{r as l,u as k,a as $,j as s,T as B,I as y,B as j,c as m,J as p}from"./index-CiM0iehI.js";/* empty css                    */import{F as n}from"./index-BctfIxuD.js";import"./motion-BUbX8Cb0.js";import"./collapse-BbEVqHco.js";import"./zoom-BZWbfUq2.js";import"./Portal-C3bpsPPe.js";import"./responsiveObserver-CWjQaA9G.js";import"./index-Dx58Pgh_.js";import"./index-c8GoCNeN.js";import"./index-BB0IkGXf.js";import"./useId-CfZRftqB.js";import"./isMobile-B4CO7CVJ.js";import"./roundedArrow-CePw_OaH.js";import"./useLocale-CV7yhF7H.js";const U=()=>{var g;const[r,b]=l.useState(""),[c,E]=l.useState(""),[a,d]=l.useState(null),[x,h]=l.useState(!1),[v,f]=l.useState(!1),u=k(),i=(g=$().state)==null?void 0:g.userType,C=async()=>{try{const e=await m.get(`/api/mail?email=${r}`);return console.log(e.data),e.data}catch(e){return console.log("error :",e),null}},N=async({email:e,code:t})=>{try{const o=await m.post("/api/mail",{email:e,code:t});return console.log(o.data),o.data}catch(o){return console.log(o),null}},I=async e=>{try{const t=await m.get(`/api/user/sign-up?email=${e}`);return f(t.data.data),t.data.data===!0?p.success("사용 가능한 이메일입니다"):p.error("이미 사용중인 이메일입니다"),t.data.data}catch(t){return console.log(t),p.error("이메일 중복 확인 중 오류가 발생했습니다"),f(!1),!1}};l.useEffect(()=>{if(a!==null&&a>0){const e=setInterval(()=>{d(t=>t!==null&&t>0?t-1:0)},1e3);return()=>clearInterval(e)}else a===0&&h(!0)},[a]);const S=async()=>{await N({email:r,code:c})&&(i==="user"?u("/signup/user",{state:{email:r,userType:i}}):i==="business"&&u("/signup/business",{state:{email:r,userType:i}}))},T=async e=>{const t=e.target.value;t&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)&&await I(t)},w=async()=>{d(300),h(!1),await C()};return s.jsxs("div",{children:[s.jsx(B,{title:"이메일 인증",icon:"back",onClick:()=>u(-1)}),s.jsxs(n,{autoComplete:"off",layout:"vertical",className:"mt-6 px-4",onFinish:S,children:[s.jsxs(n.Item,{label:"이메일",className:"custom-form-item !text-xs",rules:[{required:!0,message:"Please input!"}],children:[s.jsx(y,{placeholder:"이메일을 입력하세요",className:"py-[14px] px-3",value:r,onBlur:T,onChange:e=>b(e.target.value)}),s.jsx(j,{type:"primary",className:"text-xs font-medium inline-block px-4 !h-auto",onClick:w,disabled:!v,children:"인증코드 받기"})]}),s.jsxs(n.Item,{label:"인증코드",rules:[{required:!0,message:x?"입력 시간이 초과되었습니다":"인증 코드를 다시 입력해주세요"}],className:"custom-form-item !text-xs mt-3",children:[s.jsx(y,{className:"py-[14px] px-3 relative",value:c,onChange:e=>E(e.target.value),disabled:x||a===null}),s.jsx("div",{className:"text-primary text-base absolute top-1/2 -translate-y-1/2 right-4 ",children:a!==null?a>0?`${Math.floor(a/60)}:${String(a%60).padStart(2,"0")}`:"시간 초과":""})]}),s.jsxs("p",{className:"text-xs text-slate-400",children:["메일을 받지 못했다면 인증 코드 재전송을 요청하거나 스팸 메일함을 확인해 보세요. 이메일이 오지 않았나요?"," ",s.jsx("span",{className:"text-slate-600 underline cursor-pointer",children:"이메일 재발송"})]}),s.jsx(n.Item,{children:s.jsx(j,{type:"primary",htmlType:"submit",className:"text-base py-3 !h-auto w-full mt-6",disabled:!r||!c,children:"이메일 인증"})})]})]})};export{U as default};

import{G as z,c as A,u as _,J as I,r as g,e as v,j as e,T as G,B as w,Q as U,a7 as J,Z as K,U as F,S as B,bo as Q,g as Y,N as q,I as W}from"./index-DZF_lMwV.js";import{s as $}from"./searchAtom-CgiKEGyj.js";import{F as X}from"./index-Calry11s.js";import"./swiper-react-DGr9Ps00.js";import{o as S,c as T}from"./search-CYEcxJpF.js";import{e as ee,c as te}from"./match-DOxPiXvs.js";import{f as ae}from"./index-C8yBNrXo.js";import{F as se}from"./index-CtHLdL8P.js";import{N as re}from"./NoData-DFIY8mSl.js";import{R as le}from"./index-DZ82jsPs.js";import{S as ce}from"./index-BKGhn_Z3.js";import{S as oe}from"./index-Bv825Ok0.js";import"./index-BDHbZjIV.js";import"./index-DWVMhexM.js";import"./index-CqiZLVFA.js";import"./index-BMyrdrr4.js";import"./motion-DnGLBzQj.js";import"./collapse-BbEVqHco.js";import"./zoom-CNuMB0di.js";import"./Portal-hI7XGsNB.js";import"./useBreakpoint-Dmvi043U.js";import"./index-BG6u9KEd.js";import"./index-Cbswu_Hk.js";import"./index-D-wHe6FV.js";import"./useId-DRiPHj_v.js";import"./isMobile-DjGTsQxe.js";import"./roundedArrow-7xBDnTzZ.js";import"./useLocale-B0IsDvs_.js";import"./Overflow-CxqoPdPw.js";import"./PurePanel-DLwO8SDB.js";import"./useIcons-DDKaph2O.js";import"./CheckOutlined-B95BnGwp.js";import"./DownOutlined-CHeJKV1x.js";function ne(s){return z({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M6 9.5C6.93191 9.5 7.71496 10.1374 7.93699 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7455 13.8231 11.9496 13.5899 11.9919L13.5 12L7.93673 12.001C7.71435 12.8631 6.93155 13.5 6 13.5C5.06845 13.5 4.28565 12.8631 4.06327 12.001L2.5 12C2.22386 12 2 11.7761 2 11.5C2 11.2545 2.17688 11.0504 2.41012 11.0081L2.5 11H4.06301C4.28504 10.1374 5.06809 9.5 6 9.5ZM6 10.5C5.44772 10.5 5 10.9477 5 11.5C5 12.0523 5.44772 12.5 6 12.5C6.55228 12.5 7 12.0523 7 11.5C7 10.9477 6.55228 10.5 6 10.5ZM10 2.5C10.9319 2.5 11.715 3.13738 11.937 3.99998L13.5 4C13.7761 4 14 4.22386 14 4.5C14 4.74546 13.8231 4.94961 13.5899 4.99194L13.5 5L11.9367 5.00102C11.7144 5.86312 10.9316 6.5 10 6.5C9.06845 6.5 8.28565 5.86312 8.06327 5.00102L2.5 5C2.22386 5 2 4.77614 2 4.5C2 4.25454 2.17688 4.05039 2.41012 4.00806L2.5 4L8.06301 3.99998C8.28504 3.13738 9.06809 2.5 10 2.5ZM10 3.5C9.44772 3.5 9 3.94772 9 4.5C9 5.05228 9.44772 5.5 10 5.5C10.5523 5.5 11 5.05228 11 4.5C11 3.94772 10.5523 3.5 10 3.5Z"},child:[]}]})(s)}const ie=({setIsAmenityOpen:s})=>{const[N]=se.useForm(),[i]=A(),c=i.get("keyword"),y=i.get("category");i.get("orderType"),i.get("filter");const u=_(),[r,x]=I($),d=g.useCallback(async()=>{const o=r.amenityId.map(l=>`amenity_id=${l.amenity_id}`).join("&");try{const l=await v.get(`/api/search/filter?start_idx=0&category=숙소&search_word=${c}&${o}`);console.log("편의시설",l.data);const C=l.data;C.code==="200 성공"&&x(R=>({...R,searchData:C.data,more:C.data[0].more}))}catch(l){console.log("편의시설",l)}},[]);g.useEffect(()=>{console.log("선택된 필터",r.amenityId)},[r.amenityId]);const k=()=>{s(!1),x(o=>({...o,amenityId:[]}))},h=()=>{x(o=>({...o,amenityId:[]}))},b=o=>{x(l=>({...l,orderType:o}))},n=o=>{r.amenityId.includes(o)?x({...r,amenityId:r.amenityId.filter(l=>l!==o)}):x({...r,amenityId:[...r.amenityId,o]})},p=()=>{console.log("handleSubmit",r),x(o=>({...o,fromContent:!1})),s(!1),r.amenityId.length>0?(d(),u(`/search/strf?keyword=${c}&category=${y}&orderType=${r.orderType}&filter=selected`)):u(`/search/strf?keyword=${c}&category=${y}&orderType=${r.orderType}&filter=none`)};return e.jsx("div",{className:`fixed top-0 left-[50%] translate-x-[-50%] z-10\r
            max-w-[768px] w-full mx-auto h-screen\r
            bg-white`,children:e.jsxs("div",{className:"relative h-full",children:[e.jsx(G,{title:"필터",onClick:k}),e.jsxs("section",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"px-4 py-6",children:[e.jsx("h4",{className:"py-2 text-base font-semibold text-slate-700",children:"정렬"}),e.jsx("ul",{children:S.map((o,l)=>e.jsx("li",{className:"py-3 border-b border-slate-100",onClick:()=>b(l),children:e.jsx("button",{className:`text-sm  hover:text-primary transition-all duration-75
                      ${r.orderType===l?"text-primary":"text-slate-700"}`,children:o.name})},l))})]}),e.jsxs("div",{className:"px-4 py-6 flex flex-col gap-3",children:[e.jsx("h4",{className:"text-base font-semibold text-slate-700",children:"편의시설"}),e.jsx("ul",{className:"flex flex-wrap gap-[6px]",children:ee.map((o,l)=>{var C;return e.jsx("li",{onClick:()=>n(o),className:`w-fit px-3 py-[6px] rounded-lg border text-sm select-none cursor-pointer ${(C=r.amenityId)!=null&&C.includes(o)?"text-primary border-primary":"text-slate-500 border-slate-200"}`,children:o.key},l)})})]})]}),e.jsxs("section",{className:` absolute bottom-0 left-0 right-0 bg-white\r
      flex items-center gap-3 px-4 py-4 border-t border-slate-100`,children:[e.jsxs(w,{className:"px-[14px] py-3 !h-auto text-base text-slate-500",onClick:h,children:[e.jsx(ae,{className:"text-slate-300"}),"초기화"]}),e.jsx(w,{type:"primary",className:"w-full px-[14px] py-3 !h-auto text-base",onClick:p,children:"적용하기"})]})]})})},D=({item:s,onClick:N})=>{var r,x,d;const i=_(),[c,y]=I($),u=k=>{console.log("아이템 클릭"),y(h=>({...h,fromContent:!0})),i(`/contents/index?strfId=${k.strfId}`)};return e.jsxs("div",{className:"flex gap-[20px] items-center cursor-pointer",onClick:()=>u(s),children:[e.jsx("div",{className:"w-[130px] h-[130px] bg-slate-200 rounded-[8px] overflow-hidden select-none",children:e.jsx("img",{src:`${U}/${s.strfId}/${s.strfPic}`,alt:s.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-[5px]",children:[e.jsx("div",{className:"flex gap-[5px] items-center ",children:e.jsx("h3",{className:"text-[20px] font-semibold text-slate-700 select-none",children:s.title||s.strfTitle})}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("p",{className:"text-[14px] text-slate-500",children:te(s.category)}),e.jsx("p",{className:"text-[14px] text-slate-500",children:"|"}),e.jsx("p",{className:"text-[14px] text-slate-500",children:s.locationName})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx(le,{disabled:!0,count:1,value:s.hasMyReview!==0?1:0}),e.jsx("p",{className:"text-[12px] text-slate-500",children:s.averageRating?s.averageRating:"0"}),e.jsxs("p",{className:"text-[12px] text-slate-500",children:["(",s.reviewCount?(r=s.reviewCount)==null?void 0:r.toLocaleString():(x=s.reviewCnt)==null?void 0:x.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("div",{children:s.wishIn?e.jsx(J,{className:"text-secondary3"}):e.jsx(K,{className:"text-slate-400"})}),e.jsx("p",{className:"text-[12px] text-slate-500",children:(d=s.wishlistCount)==null?void 0:d.toLocaleString()})]})]})]})},xe=()=>{const[s]=A(),N=s.get("keyword");s.get("category");const i=s.get("orderType"),c=_(),[y,u]=I($);F($);const r=B($),x=r.searchData.filter(n=>n.category==="TOUR"),d=r.searchData.filter(n=>n.category==="STAY"),k=r.searchData.filter(n=>n.category==="RESTAUR"),h=r.searchData.filter(n=>n.category==="FEST"),b=n=>{u(p=>({...p,category:n,searchData:[]})),c(`/search/strf?keyword=${N}&category=${n}&orderType=${i}`),Q()};return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"관광지"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:x.map((n,p)=>e.jsx(D,{item:n},p))}),e.jsx(w,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>b(1),children:"더보기"})]}),e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"숙소"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:d.map((n,p)=>e.jsx(D,{item:n},p))}),e.jsx(w,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>b(2),children:"더보기"})]}),e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"맛집"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:k.map((n,p)=>e.jsx(D,{item:n},p))}),e.jsx(w,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>b(3),children:"더보기"})]}),e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"축제"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:h.map((n,p)=>e.jsx(D,{item:n},p))}),e.jsx(w,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>b(4),children:"더보기"})]})]})},ze=()=>{const s=Y("accessToken"),[N]=A(),i=N.get("keyword"),c=Number(N.get("category")),y=Number(N.get("orderType")),u=N.get("filter"),r=_(),[x,d]=I($),k=F($),h=B($),b=g.useRef(null);g.useRef(null);const[n,p]=g.useState(!1),[o,l]=g.useState(!1),C=g.useCallback(()=>{},[]),R=g.useCallback(async t=>{const a=`/api/search/all?search_word=${t}`;if(l(!0),s)try{const f=(await v.get(a,{headers:{Authorization:`Bearer ${s}`}})).data;f&&l(!1),d(j=>({...j,searchData:f.data,start_idx:0,category:0,amenityId:[],orderType:0}))}catch(m){console.log("전체 검색",m),l(!1)}else try{const f=(await v.get(a)).data;f&&l(!1),d(j=>({...j,searchData:f.data}))}catch(m){console.log("전체 검색",m),l(!1)}},[]),L=async()=>{const t="/api/search/category";if(l(!0),s)try{const m=(await v.get(`${t}?start_idx=${x.start_idx}&category=${T[c].name}&search_word=${i}&order_type=${S[y].type}`,{headers:{Authorization:`Bearer ${s}`}})).data;m.code==="200 성공"&&(l(!1),d(f=>{var j;return{...f,searchData:[...f.searchData,...m.data],more:(j=m.data[0])==null?void 0:j.more}}))}catch(a){console.log("카테고리 검색",a)}else try{const m=(await v.get(`${t}?start_idx=${x.start_idx}&category=${T[c].name}&search_word=${i}&order_type=${S[y].type}`)).data;m.code==="200 성공"&&(l(!1),d(f=>{var j;return{...f,searchData:[...f.searchData,...m.data],more:(j=m.data[0])==null?void 0:j.more}}))}catch(a){console.log("카테고리 검색",a)}},E=g.useCallback(async()=>{const t=x.amenityId.map(a=>`amenity_id=${a.amenity_id}`).join("&");try{const a=await v.get(`/api/search/filter?start_idx=${x.start_idx}&category=숙소&search_word=${i}&${t}`);console.log("편의시설",a.data);const m=a.data;m.code==="200 성공"&&d(f=>({...f,searchData:[...f.searchData,...m.data],more:m.data[0].more}))}catch(a){console.log("편의시설",a)}},[]),P=async()=>{try{const t=await v.get(`/api/search/count?category=${T[c].name}&search_word=${i}`);console.log("검색 총 수",t.data),d(a=>({...a,count:t.data.data}))}catch(t){console.log("검색 총 수",t)}},M=t=>{k(),t.target.value.trim()&&(d(a=>({...a,fromContent:!1})),r(`/search/strf?keyword=${t.target.value}&category=${c}&orderType=${y}`))},H=t=>{r(`/search/strf?keyword=${i}&category=${t}&orderType=${y}`),t!==c&&d(a=>({...a,start_idx:0,searchData:[],category:t,fromContent:!1}))},O=t=>{r(`/search/strf?keyword=${i}&category=${c}&orderType=${t}`),d(a=>({...a,orderType:t,start_idx:0,fromContent:!1,searchData:[]}))},Z=()=>{d(t=>({...t,start_idx:t.start_idx+10})),L()},V=()=>{p(!0)};return g.useEffect(()=>{c===0?R(i):h.fromContent===!1&&(L(),P())},[i,c,y]),e.jsxs("div",{className:"w-full flex flex-col mb-[100px]",children:[e.jsxs("section",{className:"w-full px-4 py-4 flex items-center gap-3 relative",ref:b,children:[e.jsx("div",{className:"text-3xl cursor-pointer",onClick:()=>{r(c===0?"/search/before":`/search/strf?keyword=${i}&category=0&orderType=${y}`)},children:e.jsx(q,{})}),e.jsx("label",{htmlFor:"searchBar",className:"relative w-full",children:e.jsx(W,{id:"searchBar",placeholder:"관광지, 장소, 숙소,맛집을 검색해 보세요",allowClear:!0,onClear:C,suffix:e.jsx(X,{className:"text-slate-400 text-2xl"}),defaultValue:i,onPressEnter:t=>M(t),variant:"filled",className:`max-h-[60px] h-[16vw] text-base rounded-lg gap-[5px]\r
            bg-slate-50 hover:bg-slate-100 placeholder:text-slate-400 `})})]}),e.jsxs("section",{className:"pb-8 flex flex-col",children:[e.jsx("ul",{className:"py-4 flex gap-3 px-4 ",children:T.map((t,a)=>e.jsx("li",{className:`cursor-pointer text-sm w-full flex justify-center items-center py-2 gap-[10px] rounded-xl ${a===c?"bg-primary text-white":"bg-white text-slate-500"}`,onClick:()=>{H(a)},children:e.jsxs("p",{className:"text-center",children:[" ",t.name]})},a))}),e.jsx("div",{className:"h-[2.66vw] max-h-[10px] bg-slate-100"}),c!==0&&e.jsxs("div",{className:"flex items-center gap-3 justify-between py-4",children:[e.jsx("div",{className:"text-xs text-slate-700 font-semibold",children:c===0?null:`총 ${h.count}개`}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(w,{onClick:V,type:"button",className:`text-xs
                    ${c===2?"visible":"invisible"}
                    ${u==="selected"?"text-primary":"text-slate-500"}`,children:["필터 ",e.jsx(ne,{})]}),c!==0&&e.jsx(ce,{value:h.orderType,onChange:O,options:S.map((t,a)=>({value:a,label:e.jsx("span",{className:"text-slate-500 text-xs",children:t.name})})),style:{color:"#64748b"},className:"h-[4.53vw] max-h-[17px]",variant:"borderless"})]})]})]}),e.jsxs("section",{className:"px-8 pb-8 flex flex-col min-h-screen",children:[e.jsxs(oe,{spinning:o,children:[h.searchData.length===0&&o===!0&&e.jsx("div",{className:"flex flex-col items-center p-20"}),h.searchData.length===0&&o===!1&&e.jsx(re,{content:"검색 결과가 없습니다."}),h.searchData.length>0&&c===0&&e.jsx(xe,{}),h.searchData.length>0&&c!==0&&e.jsx("ul",{className:"flex flex-col gap-[20px]",children:h.searchData.map((t,a)=>e.jsx(D,{item:t},a))})]}),c!==0&&h.more&&e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx(w,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>{u==="none"?Z():E()},children:"더보기"})})]}),n&&e.jsx(ie,{setIsAmenityOpen:p})]})};export{ze as default};

import{G,c as _,u as T,Q as S,r as j,e as k,j as e,T as U,B as b,V as z,aa as K,a1 as Q,X as L,W as F,bl as W,g as X,U as Y,I as q}from"./index-BntdmLw6.js";import{s as C}from"./searchAtom-CC56KfOB.js";import{F as J}from"./index-DGDOMr42.js";import"./swiper-react-C0be-MHq.js";import{o as R,c as I}from"./search-CYEcxJpF.js";import{e as ee,c as te}from"./match-QPO8WXvd.js";import{f as ae}from"./index-DlpCU_wW.js";import{F as se}from"./index-8ukATiw3.js";import{N as re}from"./NoData-DMGT0edu.js";import{R as le}from"./index-CGR3KpPN.js";import{S as ce}from"./index-CvW-_NZc.js";import{S as oe}from"./index-xetdIjy9.js";import"./index-D--tJV0U.js";import"./index-_SN7yVUb.js";import"./index-uPMp8crv.js";import"./index-B594j0i6.js";import"./motion-C0u11WnX.js";import"./collapse-BbEVqHco.js";import"./zoom-CZrdmVqU.js";import"./Portal-DrvEm9SG.js";import"./responsiveObserver-B1zAiPzw.js";import"./index-f2vjQ5p_.js";import"./index-BwdDw7dk.js";import"./index-CQPU18Q9.js";import"./useId-1CjrgjZ5.js";import"./isMobile-B4CO7CVJ.js";import"./roundedArrow-BJTQLzTE.js";import"./useLocale-DTUvsN8S.js";import"./Overflow-DP5qerSy.js";import"./PurePanel-UKNAQVax.js";import"./useIcons-Ds5xDlqb.js";import"./CheckOutlined-hbsPTsj_.js";import"./DownOutlined-B2Akvkot.js";function ne(s){return G({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M6 9.5C6.93191 9.5 7.71496 10.1374 7.93699 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7455 13.8231 11.9496 13.5899 11.9919L13.5 12L7.93673 12.001C7.71435 12.8631 6.93155 13.5 6 13.5C5.06845 13.5 4.28565 12.8631 4.06327 12.001L2.5 12C2.22386 12 2 11.7761 2 11.5C2 11.2545 2.17688 11.0504 2.41012 11.0081L2.5 11H4.06301C4.28504 10.1374 5.06809 9.5 6 9.5ZM6 10.5C5.44772 10.5 5 10.9477 5 11.5C5 12.0523 5.44772 12.5 6 12.5C6.55228 12.5 7 12.0523 7 11.5C7 10.9477 6.55228 10.5 6 10.5ZM10 2.5C10.9319 2.5 11.715 3.13738 11.937 3.99998L13.5 4C13.7761 4 14 4.22386 14 4.5C14 4.74546 13.8231 4.94961 13.5899 4.99194L13.5 5L11.9367 5.00102C11.7144 5.86312 10.9316 6.5 10 6.5C9.06845 6.5 8.28565 5.86312 8.06327 5.00102L2.5 5C2.22386 5 2 4.77614 2 4.5C2 4.25454 2.17688 4.05039 2.41012 4.00806L2.5 4L8.06301 3.99998C8.28504 3.13738 9.06809 2.5 10 2.5ZM10 3.5C9.44772 3.5 9 3.94772 9 4.5C9 5.05228 9.44772 5.5 10 5.5C10.5523 5.5 11 5.05228 11 4.5C11 3.94772 10.5523 3.5 10 3.5Z"},child:[]}]})(s)}const ie=({setIsAmenityOpen:s})=>{se.useForm();const[f]=_(),x=f.get("keyword"),c=f.get("category");f.get("orderType"),f.get("filter");const y=T(),[o,n]=S(C),u=j.useCallback(async()=>{const t=o.amenityId.map(i=>`amenity_id=${i.amenity_id}`).join("&");try{const i=await k.get(`/api/search/filter?start_idx=0&category=숙소&search_word=${x}&${t}`);console.log("편의시설",i.data);const h=i.data;h.code==="200 성공"&&n(D=>({...D,searchData:h.data,more:h.data[0].more}))}catch(i){console.log("편의시설",i)}},[]);j.useEffect(()=>{console.log("선택된 필터",o.amenityId)},[o.amenityId]);const d=()=>{s(!1),n(t=>({...t,amenityId:[]}))},w=()=>{n(t=>({...t,amenityId:[]}))},m=t=>{n(i=>({...i,orderType:t}))},N=t=>{o.amenityId.includes(t)?n({...o,amenityId:o.amenityId.filter(i=>i!==t)}):n({...o,amenityId:[...o.amenityId,t]})},l=()=>{console.log("handleSubmit",o),n(t=>({...t,fromContent:!1})),s(!1),o.amenityId.length>0?(u(),y(`/search/strf?keyword=${x}&category=${c}&orderType=${o.orderType}&filter=selected`)):y(`/search/strf?keyword=${x}&category=${c}&orderType=${o.orderType}&filter=none`)};return e.jsx("div",{className:`fixed top-0 left-[50%] translate-x-[-50%] z-10\r
            max-w-[768px] w-full mx-auto h-screen\r
            bg-white`,children:e.jsxs("div",{className:"relative h-full",children:[e.jsx(U,{title:"필터",onClick:d}),e.jsxs("section",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"px-4 py-6",children:[e.jsx("h4",{className:"py-2 text-base font-semibold text-slate-700",children:"정렬"}),e.jsx("ul",{children:R.map((t,i)=>e.jsx("li",{className:"py-3 border-b border-slate-100",onClick:()=>m(i),children:e.jsx("button",{className:`text-sm  hover:text-primary transition-all duration-75
                      ${o.orderType===i?"text-primary":"text-slate-700"}`,children:t.name})},i))})]}),e.jsxs("div",{className:"px-4 py-6 flex flex-col gap-3",children:[e.jsx("h4",{className:"text-base font-semibold text-slate-700",children:"편의시설"}),e.jsx("ul",{className:"flex flex-wrap gap-[6px]",children:ee.map((t,i)=>{var h;return e.jsx("li",{onClick:()=>N(t),className:`w-fit px-3 py-[6px] rounded-lg border text-sm select-none cursor-pointer ${(h=o.amenityId)!=null&&h.includes(t)?"text-primary border-primary":"text-slate-500 border-slate-200"}`,children:t.key},i)})})]})]}),e.jsxs("section",{className:` absolute bottom-0 left-0 right-0 bg-white\r
      flex items-center gap-3 px-4 py-4 border-t border-slate-100`,children:[e.jsxs(b,{className:"px-[14px] py-3 !h-auto text-base text-slate-500",onClick:w,children:[e.jsx(ae,{className:"text-slate-300"}),"초기화"]}),e.jsx(b,{type:"primary",className:"w-full px-[14px] py-3 !h-auto text-base",onClick:l,children:"적용하기"})]})]})})},$=({item:s,onClick:f})=>{var n,u,d;const x=T(),[c,y]=S(C),o=w=>{console.log("아이템 클릭"),y(m=>({...m,fromContent:!0})),x(`/contents/index?strfId=${w.strfId}`)};return e.jsxs("div",{className:"flex gap-[20px] items-center cursor-pointer",onClick:()=>o(s),children:[e.jsx("div",{className:"w-[130px] h-[130px] bg-slate-200 rounded-[8px] overflow-hidden select-none",children:e.jsx("img",{src:`${z}/${s.strfId}/${s.strfPic}`,alt:s.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-[5px]",children:[e.jsx("div",{className:"flex gap-[5px] items-center ",children:e.jsx("h3",{className:"text-[20px] font-semibold text-slate-700 select-none",children:s.title||s.strfTitle})}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("p",{className:"text-[14px] text-slate-500",children:te(s.category)}),e.jsx("p",{className:"text-[14px] text-slate-500",children:"|"}),e.jsx("p",{className:"text-[14px] text-slate-500",children:s.locationName})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx(le,{disabled:!0,count:1,value:s.hasMyReview!==0?1:0}),e.jsx("p",{className:"text-[12px] text-slate-500",children:s.averageRating?s.averageRating:"0"}),e.jsxs("p",{className:"text-[12px] text-slate-500",children:["(",s.reviewCount?(n=s.reviewCount)==null?void 0:n.toLocaleString():(u=s.reviewCnt)==null?void 0:u.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("div",{children:s.wishIn?e.jsx(K,{className:"text-secondary3"}):e.jsx(Q,{className:"text-slate-400"})}),e.jsx("p",{className:"text-[12px] text-slate-500",children:(d=s.wishlistCount)==null?void 0:d.toLocaleString()})]})]})]})},xe=()=>{const[s]=_(),f=s.get("keyword");s.get("category");const x=s.get("orderType"),c=T(),[y,o]=S(C);L(C);const n=F(C),u=n.searchData.filter(l=>l.category==="TOUR"),d=n.searchData.filter(l=>l.category==="STAY"),w=n.searchData.filter(l=>l.category==="RESTAUR"),m=n.searchData.filter(l=>l.category==="FEST"),N=l=>{o(t=>({...t,category:l,searchData:[]})),c(`/search/strf?keyword=${f}&category=${l}&orderType=${x}`),W()};return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"관광지"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:u.map((l,t)=>e.jsx($,{item:l},t))}),e.jsx(b,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>N(1),children:"더보기"})]}),e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"숙소"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:d.map((l,t)=>e.jsx($,{item:l},t))}),e.jsx(b,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>N(2),children:"더보기"})]}),e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"맛집"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:w.map((l,t)=>e.jsx($,{item:l},t))}),e.jsx(b,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>N(3),children:"더보기"})]}),e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"축제"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:m.map((l,t)=>e.jsx($,{item:l},t))}),e.jsx(b,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>N(4),children:"더보기"})]})]})},Ge=()=>{const s=X("accessToken"),[f]=_(),x=f.get("keyword"),c=Number(f.get("category")),y=Number(f.get("orderType")),o=f.get("filter"),n=T(),[u,d]=S(C),w=L(C),m=F(C),N=j.useRef(null);j.useRef(null);const[l,t]=j.useState(!1),[i,h]=j.useState(!1),D=j.useCallback(()=>{},[]),B=j.useCallback(async a=>{const r=`/api/search/all?search_word=${a}`;if(h(!0),s)try{const g=(await k.get(r,{headers:{Authorization:`Bearer ${s}`}})).data;g&&h(!1),d(v=>({...v,searchData:g.data,start_idx:0,category:0,amenityId:[],orderType:0}))}catch(p){console.log("전체 검색",p),h(!1)}else try{const g=(await k.get(r)).data;g&&h(!1),d(v=>({...v,searchData:g.data}))}catch(p){console.log("전체 검색",p),h(!1)}},[]),A=async()=>{const a="/api/search/category";h(!0);try{const p=(await k.get(`${a}?start_idx=${u.start_idx}&category=${I[c].name}&search_word=${x}&order_type=${R[y].type}`)).data;p.code==="200 성공"&&(h(!1),d(g=>{var v;return{...g,searchData:[...g.searchData,...p.data],more:(v=p.data[0])==null?void 0:v.more}}))}catch(r){console.log("카테고리 검색",r)}},E=j.useCallback(async()=>{const a=u.amenityId.map(r=>`amenity_id=${r.amenity_id}`).join("&");try{const r=await k.get(`/api/search/filter?start_idx=${u.start_idx}&category=숙소&search_word=${x}&${a}`);console.log("편의시설",r.data);const p=r.data;p.code==="200 성공"&&d(g=>({...g,searchData:[...g.searchData,...p.data],more:p.data[0].more}))}catch(r){console.log("편의시설",r)}},[]),P=async()=>{try{const a=await k.get(`/api/search/count?category=${I[c].name}&search_word=${x}`);console.log("검색 총 수",a.data),d(r=>({...r,count:a.data.data}))}catch(a){console.log("검색 총 수",a)}},M=a=>{w(),a.target.value.trim()&&(d(r=>({...r,fromContent:!1})),n(`/search/strf?keyword=${a.target.value}&category=${c}&orderType=${y}`))},H=a=>{n(`/search/strf?keyword=${x}&category=${a}&orderType=${y}`),a!==c&&d(r=>({...r,start_idx:0,searchData:[],category:a,fromContent:!1}))},O=a=>{n(`/search/strf?keyword=${x}&category=${c}&orderType=${a}`),d(r=>({...r,orderType:a,start_idx:0,fromContent:!1,searchData:[]}))},V=()=>{d(a=>({...a,start_idx:a.start_idx+10})),A()},Z=()=>{t(!0)};return j.useEffect(()=>{c===0?B(x):m.fromContent===!1&&(A(),P())},[x,c,y]),e.jsxs("div",{className:"w-full flex flex-col mb-[100px]",children:[e.jsxs("section",{className:"w-full px-4 py-4 flex items-center gap-3 relative",ref:N,children:[e.jsx("div",{className:"text-3xl cursor-pointer",onClick:()=>{n(c===0?"/search/before":`/search/strf?keyword=${x}&category=0&orderType=${y}`)},children:e.jsx(Y,{})}),e.jsx("label",{htmlFor:"searchBar",className:"relative w-full",children:e.jsx(q,{id:"searchBar",placeholder:"관광지, 장소, 숙소,맛집을 검색해 보세요",allowClear:!0,onClear:D,suffix:e.jsx(J,{className:"text-slate-400 text-2xl"}),defaultValue:x,onPressEnter:a=>M(a),variant:"filled",className:`max-h-[60px] h-[16vw] text-base rounded-lg gap-[5px]\r
            bg-slate-50 hover:bg-slate-100 placeholder:text-slate-400 `})})]}),e.jsxs("section",{className:"pb-8 flex flex-col",children:[e.jsx("ul",{className:"py-4 flex gap-3 px-4 ",children:I.map((a,r)=>e.jsx("li",{className:`cursor-pointer text-sm w-full flex justify-center items-center py-2 gap-[10px] rounded-xl ${r===c?"bg-primary text-white":"bg-white text-slate-500"}`,onClick:()=>{H(r)},children:e.jsxs("p",{className:"text-center",children:[" ",a.name]})},r))}),e.jsx("div",{className:"h-[2.66vw] max-h-[10px] bg-slate-100"}),c!==0&&e.jsxs("div",{className:"flex items-center gap-3 justify-between py-4",children:[e.jsx("div",{className:"text-xs text-slate-700 font-semibold",children:c===0?null:`총 ${m.count}개`}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(b,{onClick:Z,type:"button",className:`text-xs
                    ${c===2?"visible":"invisible"}
                    ${o==="selected"?"text-primary":"text-slate-500"}`,children:["필터 ",e.jsx(ne,{})]}),c!==0&&e.jsx(ce,{value:m.orderType,onChange:O,options:R.map((a,r)=>({value:r,label:e.jsx("span",{className:"text-slate-500 text-xs",children:a.name})})),style:{color:"#64748b"},className:"h-[4.53vw] max-h-[17px]",variant:"borderless"})]})]})]}),e.jsxs("section",{className:"px-8 pb-8 flex flex-col min-h-screen",children:[e.jsxs(oe,{spinning:i,children:[m.searchData.length===0&&i===!0&&e.jsx("div",{className:"flex flex-col items-center p-20"}),m.searchData.length===0&&i===!1&&e.jsx(re,{content:"검색 결과가 없습니다."}),m.searchData.length>0&&c===0&&e.jsx(xe,{}),m.searchData.length>0&&c!==0&&e.jsx("ul",{className:"flex flex-col gap-[20px]",children:m.searchData.map((a,r)=>e.jsx($,{item:a},r))})]}),m.more&&e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx(b,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>{o==="none"?V():E()},children:"더보기"})})]}),l&&e.jsx(ie,{setIsAmenityOpen:t})]})};export{Ge as default};

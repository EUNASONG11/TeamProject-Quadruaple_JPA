import{d as c,r as a,u as k,g as y,j as e,V as A,ab as F,e as N,N as u,B as d,W as O,T as P}from"./index-BntdmLw6.js";import{j as E}from"./jwt-fW46sxL_.js";import{u as R}from"./userAtom-BmnMlBu9.js";import{F as z}from"./Footer-Ckl2qXbW.js";import{B as V}from"./BottomSheet-BJ5uX72Z.js";import{b as _}from"./index-Chc8-wYj.js";import"./ko-Da14ESg7.js";import"./DockBar-CNFz1Jez.js";import"./index-DGDOMr42.js";import"./index-uPMp8crv.js";import"./searchAtom-CC56KfOB.js";import"./proxy-UoHTkF4V.js";c.locale("ko");const q=o=>{console.log(o.bookingId);const{checkInDate:g,checkOutDate:f,strfTitle:n,strfPic:m,price:p,state:i,strfId:h,checkInTime:D,checkOutTime:b,createdAt:t,bookingId:s}=o.data,v=k(),w=y("accessToken"),M=[{label:e.jsxs("p",{className:"flex items-center gap-3 px-4 py-[14px] text-lg text-slate-500",children:[e.jsx(_,{className:"text-slate-300"}),"문의하기"]}),onClick:()=>{C()}}],[B,j]=a.useState(!1),C=async()=>{const r="/api/chat-room",x={strfId:h,title:n,bookingId:s};console.log("채팅방 생성 요청",x);try{const l=await N.post(r,x,{headers:{Authorization:`Bearer ${w}`}});console.log("채팅방 생성",l.data);const Y=l.data;Y&&v(`/chatroom?roomId=${Y.data}`)}catch(l){console.log("채팅방 생성",l),u.error("채팅방 생성에 실패했습니다.")}},S=async r=>{var x;try{(await E.patch("/api/booking",{bookingId:r})).data.code==="200"?(u.success("예약이 취소되었습니다."),(x=o.getBookings)==null||x.call(o)):u.error("예약 취소에 실패했습니다.")}catch(l){console.log("예약 취소 에러:",l),u.error("예약 취소에 실패했습니다.")}};c().format("YYYY.MM.DD");const $=r=>{switch(r){case 0:return"결제완료";case 1:return"예약확정";case 2:return"이용완료";case 3:return"취소완료"}},I=r=>{switch(r){case 0:return"bg-[rgba(255,253,204,0.6)] text-[#FFCC00]";case 1:return"bg-[rgba(165,238,254,0.3)] text-primary";case 2:return"bg-slate-100 text-slate-400";case 3:return"bg-[rgba(253,180,161,0.3)] text-secondary3"}},T=r=>{switch(r){case 0:case 1:return e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"w-full h-auto py-3 rounded-lg text-base font-semibold text-slate-700",children:"상세보기"}),e.jsx(d,{onClick:()=>S(o.data.bookingId),className:"w-full h-auto py-3 rounded-lg text-base font-semibold text-slate-700",children:"예약 취소"})]});case 2:return e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"w-full h-auto py-3 rounded-lg text-base font-semibold text-slate-700",children:"상세보기"}),e.jsx(d,{type:"primary",className:"w-full h-auto py-3 rounded-lg text-base font-semibold  text-white bg-primary",children:"리뷰작성"})]});case 3:return e.jsx(e.Fragment,{children:e.jsx(d,{className:"w-full h-auto py-3 rounded-lg text-base font-semibold text-slate-700",children:"상세보기"})})}};return e.jsxs("div",{className:"w-full px-6 py-4 flex flex-col gap-4 border-b-[10px] border-slate-100 last:border-none",children:[e.jsx("div",{className:`w-fit flex items-center justify-center px-2 py-1 text-sm font-bold ${I(i)}`,children:e.jsx("p",{children:$(i)})}),e.jsx("div",{children:e.jsx("h3",{className:"text-xl font-bold text-slate-700",children:n})}),e.jsxs("div",{className:"flex gap-[20px]",children:[e.jsx("div",{className:"w-[85px] h-[85px] rounded-2xl overflow-hidden bg-slate-100",children:e.jsx("img",{src:m?`${A}/${h}/${m}`:"",alt:n||"",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-[10px]",children:[e.jsxs("div",{className:"flex items-center gap-3 text-[16px] text-slate-700",children:[e.jsx("h4",{className:"text-slate-400 font-semibold text-base tracking-tight",children:"이용일시"}),e.jsxs("p",{className:"text-base text-slate-700",children:[e.jsx("span",{children:c(g,"YYYY-MM-DD").format("YYYY.MM.DD ddd")}),e.jsx("span",{children:"~"}),e.jsx("span",{children:c(f,"YYYY-MM-DD").format("YYYY.MM.DD ddd")})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-[16px] text-slate-700",children:[e.jsx("h4",{className:"text-slate-400 font-semibold text-base",children:"예약일시"}),e.jsx("p",{className:"text-base text-slate-700 tracking-tight",children:c(t,"YYYY-MM-DD").format("YYYY.MM.DD ddd")})]}),e.jsxs("div",{className:"flex items-center gap-3 text-[16px] text-slate-700",children:[e.jsx("h4",{className:"text-slate-400 font-semibold text-base tracking-tight",children:"인원"}),e.jsx("p",{className:"text-base text-slate-700",children:c(t,"YYYY-MM-DD").format("YYYY.MM.DD ddd")})]})]})]}),e.jsxs("div",{className:"flex gap-[8px] items-center",children:[T(i),e.jsx("button",{type:"button",className:"aspect-square h-auto py-3 px-3 text-2xl text-slate-700 rounded-lg border border-slate-300 flex justify-center items-center",onClick:()=>j(!0),children:e.jsx(F,{})})]}),e.jsx(V,{open:B,onClose:()=>j(!1),actions:M})]})},G=a.memo(q),H=["예약 목록","예약 완료"],re=()=>{const o=y("accessToken");O(R);const g=k(),f=()=>{g(-1)},[n,m]=a.useState(0),[p,i]=a.useState([]);a.useState([]),a.useState([]),a.useState(!0);const[h,D]=a.useState(0),b=a.useCallback(async()=>{try{const t=await N.get(`/api/booking?page=${h}`,{headers:{Authorization:`Bearer ${o}`}});console.log("예약 목록",t.data);const s=t.data;s.code==="200 성공"&&i(s.data)}catch(t){console.log("예약 목록 불러오기 실패",t)}},[]);return a.useEffect(()=>{b()},[]),e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx(P,{icon:"back",title:"내 예약",onClick:f}),e.jsxs("div",{className:"flex flex-col gap-[20px] w-full",children:[e.jsx("div",{children:e.jsx("ul",{className:"flex gap-6 w-full border-b border-slate-200 px-[32px]",children:H.map((t,s)=>e.jsx("li",{onClick:()=>m(s),className:`flex justify-center items-center 
                  pt-[17px] pb-[16px]
                  text-lg cursor-pointer
                  border-b-[2px] transition-all duration-300 ease-in-out
                  ${s===n?"border-primary text-primary":"border-transparent text-slate-500 hover:text-primary"}`,children:t},s))})}),e.jsx("div",{className:"min-h-[500px] flex flex-col justify-center items-center",children:p==null?void 0:p.map((t,s)=>e.jsx(G,{data:t},s))}),e.jsx(z,{})]})]})};export{re as default};

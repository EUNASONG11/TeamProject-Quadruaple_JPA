import{u as J,j as e,R as K,M as Y,J as Se,B as E,D as Ie,$ as V,r as l,g as z,b as j,e as U,i as Re,d as Ae,F as $e,P as Te}from"./index-DBd-Khcf.js";import{a as Fe}from"./index-Bwda4KoF.js";import{C as _e}from"./CenterModal-gJDsY86D.js";import{a as q}from"./pic-Jp7D6aQ0.js";import{c as Q,a as Me}from"./match-DVjlzj71.js";import{A as De,a as Le}from"./index-DfmXtKup.js";import{R as Ee}from"./index-K3V9YU57.js";import{L as Pe}from"./index-Cg1qKfJx.js";import{c as m,o as H}from"./search-1EubG62x.js";import{F as b}from"./index-ndfs_a6Y.js";import{C as G}from"./index-B2eFLvY1.js";import{S as Be}from"./index-iMIvsNxs.js";import"./index-BAgFzdmO.js";import"./index-Cr7xEat1.js";import"./index-cWCFSPdP.js";import"./index-3O-sZqTb.js";import"./Portal-OmBpD-dR.js";import"./useId-DICU02I4.js";import"./zoom-DTlcNX2E.js";import"./collapse-BbEVqHco.js";import"./index-C8KclNPP.js";import"./useLocale-DGTZ8Qw_.js";import"./Checkbox-DCnLzF9v.js";import"./Overflow-jesKJbbI.js";import"./PurePanel-Bs5uXV3-.js";import"./useIcons-QBHB0YyA.js";import"./CheckOutlined-D6C59k4I.js";const Oe=o=>{o.current.scrollIntoView({behavior:"smooth"})},u=({showMore:o=!0,title:d,categoryData:p,searchValue:C,buttonClick:g})=>{const y=J(),N=r=>{y(`/contents/index?strfId=${r.strfId}`)};return e.jsxs("div",{className:"flex flex-col gap-[20px] items-center",children:[e.jsx("h2",{className:"w-full text-[24px] font-semibold text-slate-700",children:d}),e.jsx("ul",{className:"w-full flex flex-col gap-[20px] mb-[30px]",children:p==null?void 0:p.map((r,c)=>{var n,a;return e.jsxs("li",{className:"flex gap-[20px] items-center cursor-pointer",onClick:()=>{N(r)},children:[e.jsx("div",{className:"w-[130px] h-[130px] bg-slate-200 rounded-[8px] overflow-hidden",children:e.jsx("img",{src:`${q}${r.strfId}/${r.strfPic}`,alt:r.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-[5px]",children:[e.jsx("div",{className:"flex gap-[5px] items-center ",children:e.jsx("h3",{className:"text-[20px] font-semibold text-slate-700",children:r.title||r.strfTitle})}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("p",{className:"text-[14px] text-slate-500",children:Q(r.category)}),e.jsx("p",{className:"text-[14px] text-slate-500",children:"|"}),e.jsx("p",{className:"text-[14px] text-slate-500",children:r.locationName})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx(Ee,{disabled:!0,count:1,value:r.hasMyReview!==0?1:0}),e.jsx("p",{className:"text-[12px] text-slate-500",children:r.averageRating?r.averageRating:r.ratingAvg?r.ratingAvg:"0"}),e.jsxs("p",{className:"text-[12px] text-slate-500",children:["(",(n=r.reviewCount)==null?void 0:n.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("div",{children:r.wishIn?e.jsx(De,{className:"text-secondary3"}):e.jsx(Le,{className:"text-slate-400"})}),e.jsx("p",{className:"text-[12px] text-slate-500",children:(a=r.wishlistCount)==null?void 0:a.toLocaleString()})]})]})]},c)})}),o&&e.jsxs("button",{type:"button",className:`px-[20px] py-[10px] border border-slate-300 \r
\r
        rounded-[24px] text-[16px] font-semibold text-slate-600`,onClick:g,children:[d," 검색결과 더보기"]})]})},We=({handleClickCancle:o,getAmenitySearch:d,setAmenityValues:p,searchData:C,setSearchData:g})=>{const[y]=b.useForm();K(Y),Se.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="unset"}),[]);const N=()=>{o()},r=n=>{n.stopPropagation()},c=async n=>{var f;console.log("values",n.amenities),p(n.amenities);const a=(f=n.amenities)==null?void 0:f.map(v=>`amenity_id=${v}`).join("&");console.log("amenityIds",a),await d(a),o()};return e.jsx("div",{className:`fixed top-0 left-[50%] translate-x-[-50%] z-10\r
            max-w-3xl w-full mx-auto h-screen\r
            flex items-end justify-center\r
            bg-[rgba(0,0,0,0.5)] overflow-hidden`,onClick:()=>{N()},children:e.jsx("div",{className:`bg-white w-full \r
                px-[60px] py-[55px]\r
                flex flex-col gap-[20px]\r
                mb-[60px]\r
                `,onClick:r,children:e.jsxs(b,{form:y,onFinish:c,className:"h-[500px] flex flex-col",children:[e.jsx(b.Item,{name:"amenities",className:"flex-1 px-3 py-2 rounded-lg cursor-pointer overflow-y-auto",children:e.jsx(G.Group,{className:"flex flex-col gap-4 px-5 pt-4 w-full",children:Me.map((n,a)=>e.jsx(G,{value:n.amenity_id,className:"scale-110 !flex items-center",children:e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[e.jsx("span",{className:"text-[16px] text-slate-500",children:n.icon}),e.jsx("span",{className:"text-[20px] text-slate-700",children:n.key})]})},a))})}),e.jsx(b.Item,{children:e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(E,{color:"default",variant:"filled",onClick:o,className:"h-[40px] font-semibold text-[20px] text-slate-500",children:"취소"}),e.jsx(E,{type:"primary",htmlType:"submit",className:"h-[40px] font-semibold text-[20px]",children:"적용"})]})})]})})})},ht=()=>{var W;b.useForm();const[o,d]=K(Y);Ie(V),l.useEffect(()=>{console.log("searchRecoil",o)},[o]);const p=z("accessToken");(W=z("user"))==null||W.userId;const C=l.useRef(null),g=J(),y=()=>{g(-1),V()},[N,r]=l.useState(o.searchWord!==""),[c,n]=l.useState(o.searchWord||""),[a,f]=l.useState(o.searchData||[]),[v,k]=l.useState(o.startIndex||0),[w,X]=l.useState([]),[S,Z]=l.useState([]),[I,ee]=l.useState([]),[x,P]=l.useState(o.category||0),[R,te]=l.useState(0),[se,_]=l.useState(!1),[ae,A]=l.useState(!1),[$,M]=l.useState(!0),[le,B]=l.useState(!1),[re,ce]=l.useState([]),oe=l.useCallback(async()=>{const t="/api/search/popular";try{const s=await j.get(t);X(s.data.data)}catch(s){console.log("인기 검색어",s)}},[]),D=l.useCallback(async()=>{try{const s=(await U.get("/api/search/basic")).data;Z(s.data)}catch(t){console.log("최근 본 검색 결과",t)}},[]),ne=l.useCallback(async()=>{try{const i=(await U.get("/api/search/list")).data.data.filter(h=>h.txt!=="");ee(i)}catch(t){console.log("최근 검색어 호출 결과:",t)}},[]),ie=l.useCallback(async t=>{const s={strf_id:t.strfId};try{const i=await j.patch(`/api/recent/hide?strf_id=${t.strfId}`,{...s},{headers:{Authorization:`Bearer ${p}`}});console.log(i.data),i.data&&D()}catch(i){console.log("개별 삭제",i)}},[]),xe=l.useCallback(async()=>{try{const t=await j.patch("/api/recent/hide/all",{},{headers:{Authorization:`Bearer ${p}`}});console.log(t.data),t.data&&(D(),_(!1))}catch(t){console.log("개별 삭제",t)}},[]),L=l.useCallback(async t=>{try{const i=(await j.get(`/api/search/all?search_word=${t}`)).data;i&&(A(!0),r(!0)),f(i.data)}catch(s){console.log("전체 검색",s)}},[]),O=l.useCallback(async()=>{var t;try{const s=v,h=(await j.get(`/api/search/category?start_idx=${s}&category=${m[x].name}&search_word=${c}&order_type=${H[R].type}`)).data;h&&A(!0),h.data&&h.data.length>0&&(f(we=>s===0?h.data:[...we,...h.data]),k(s+10)),((t=h.data[0])==null?void 0:t.more)===!1&&M(!1)}catch(s){console.log("카테고리 검색",s)}},[x,v,c,R]),de=l.useCallback(async t=>{try{const s=await j.get(`/api/search/filter?start_idx=0&category=숙소&search_word=${o.searchWord}&${t}`);console.log("편의시설",s.data);const i=s.data;i.data.more===!1&&M(!1),f(i.data)}catch(s){console.log("편의시설",s)}},[]),pe=a==null?void 0:a.filter(t=>t.category==="TOUR"),me=a==null?void 0:a.filter(t=>t.category==="STAY"),fe=a==null?void 0:a.filter(t=>t.category==="RESTAUR"),he=a==null?void 0:a.filter(t=>t.category==="FEST"),ue=t=>{n(t.target.value)},ge=l.useCallback(t=>{console.log("클릭한 최근 검색어:",t),n(t.txt),L(t.txt)},[]),je=l.useCallback(t=>{console.log("클릭한 인기 검색어:",t),g(`/contents/index?strfId=${t.strfId}`)},[]),ye=l.useCallback(t=>{console.log("클릭한 최근 본 목록:",t),g(`/contents/index?strfId=${t.strfId}`)},[]),Ne=l.useCallback(()=>{n("")},[]),be=()=>{_(!1)},Ce=t=>{c.trim()&&(A(!1),L(t.target.value),d({...o,searchWord:c}),r(!0))},T=t=>{Oe(C),P(t),d({...o,category:t})},F=()=>{O()},ve=()=>{B(!0)},ke=()=>{B(!1)};return l.useEffect(()=>{oe(),p&&(D(),ne())},[]),l.useEffect(()=>{c!==""&&d({...o,searchWord:c})},[c]),l.useEffect(()=>{if(k(0),A(!1),f([]),M(!0),d(t=>({...t,startIndex:0,searchData:[]})),c.trim()){const t=setTimeout(()=>{x!==0?O():L(c)},100);return()=>clearTimeout(t)}},[x,R]),l.useEffect(()=>{(a==null?void 0:a.length)>0&&d({...o,searchData:a})},[a]),e.jsxs("div",{className:"w-full flex flex-col gap-[30px] mb-[100px]",children:[e.jsxs("div",{className:"w-full px-[32px] py-[30px] flex items-center gap-[40px] relative",ref:C,children:[e.jsx("div",{className:"text-[36px] cursor-pointer",onClick:()=>{y()},children:e.jsx(Re,{})}),e.jsx("label",{htmlFor:"searchBar",className:"relative w-full",children:e.jsx(Ae,{id:"searchBar",className:"h-[60px] text-lg rounded-lg gap-[5px]",placeholder:"관광지, 장소, 숙소,맛집을 검색해 보세요",allowClear:!0,onClear:Ne,prefix:e.jsx($e,{className:"text-slate-400 text-2xl"}),onChange:ue,onPressEnter:t=>Ce(t),variant:"filled",value:c})})]}),N?e.jsxs("div",{className:"px-[32px] py-[30px] flex flex-col gap-[30px] min-h-screen",children:[e.jsx("ul",{className:"flex justify-between items-center",children:m.map((t,s)=>e.jsx("li",{className:`cursor-pointer font-semibold text-[16px] w-full flex justify-center items-center px-[15px] py-[10px] gap-[10px] rounded-[8px] ${s===x?"bg-primary text-white":"bg-white text-slate-500"}`,onClick:()=>{k(0),P(s),d({...o,category:s})},children:t.name},s))}),e.jsxs("div",{className:"flex items-center gap-3",children:[x!==0&&e.jsx(Be,{value:R,onChange:t=>{te(t),k(0)},options:H.map((t,s)=>({value:s,label:t.name})),className:"w-[120px]",size:"middle"}),e.jsx("div",{children:x===2&&e.jsx(E,{onClick:ve,children:"편의시설 필터"})})]}),ae?(a==null?void 0:a.length)===0?e.jsxs("div",{className:"flex flex-col gap-[20px] items-center py-[100px]",children:[e.jsx("i",{className:"text-slate-300 text-[100px]",children:e.jsx(Pe,{})}),e.jsx("p",{className:"text-slate-400 text-[20px]",children:"검색 결과가 없습니다."})]}):e.jsxs(e.Fragment,{children:[x===0&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx(u,{title:m[1].name,categoryData:pe,searchValue:c,buttonClick:()=>{T(1)}}),e.jsx(u,{title:m[2].name,categoryData:me,searchValue:c,buttonClick:()=>{T(2)}}),e.jsx(u,{title:m[3].name,categoryData:fe,searchValue:c,buttonClick:()=>{T(3)}}),e.jsx(u,{title:m[4].name,categoryData:he,searchValue:c,buttonClick:()=>{T(4)}})]}),x===1&&e.jsx(u,{title:m[1].name,categoryData:a,searchValue:c,buttonClick:F,showMore:$}),x===2&&e.jsx(u,{title:m[2].name,categoryData:a,searchValue:c,buttonClick:F,showMore:$}),x===3&&e.jsx(u,{title:m[3].name,categoryData:a,searchValue:c,buttonClick:F,showMore:$}),x===4&&e.jsx(u,{title:m[4].name,categoryData:a,searchValue:c,buttonClick:F,showMore:$})]}):e.jsx("div",{className:"flex justify-center items-center h-[50vh]",children:e.jsx(Te,{color:"#0DD1FD",speedMultiplier:.8})})]}):e.jsxs("div",{className:"px-[32px] flex flex-col gap-[50px]",children:[p&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"최근 검색어"}),e.jsx("ul",{className:"flex gap-[20px] flex-wrap",children:I?I==null?void 0:I.map((t,s)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",onClick:()=>ge(t),children:t.txt},s)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"인기 검색어"}),e.jsx("ul",{className:"flex gap-[20px] flex-wrap",children:w?w==null?void 0:w.map((t,s)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",onClick:()=>je(t),children:t.strfName},s)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),p&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"최근 본 목록"}),e.jsx("button",{type:"button",className:"text-slate-400 text-[18px]",onClick:()=>_(!0),children:"모두 삭제"})]}),e.jsx("ul",{className:"flex flex-col gap-[20px]",children:S?S==null?void 0:S.map((t,s)=>e.jsxs("li",{className:"flex cursor-pointer items-center justify-between",onClick:()=>ye(t),children:[e.jsxs("div",{className:"flex gap-[15px]",children:[e.jsx("div",{className:"w-[80px] h-[80px] rounded-2xl overflow-hidden",children:e.jsx("img",{className:"w-full h-full object-cover",src:t.strfPic?`${q}${t.strfId}/${t.strfPic}`:"/images/logo_icon_4.png",alt:t.strfName})}),e.jsxs("div",{className:"flex flex-col gap-[5px] justify-center",children:[e.jsx("div",{className:"text-[18px] text-slate-700 font-semibold",children:t.strfName}),e.jsxs("div",{className:"flex gap-[5px]",children:[e.jsx("span",{className:"text-slate-500 text-[14px]",children:Q(t.category)}),e.jsx("span",{className:"text-slate-500 text-[14px]",children:"•"}),e.jsx("span",{className:"text-slate-500 text-[14px]",children:t.locationTitle})]})]})]}),e.jsx("button",{type:"button",className:"text-slate-400 text-[20px]",onClick:()=>ie(t),children:e.jsx(Fe,{})})]},s)):null})]})]}),se&&e.jsx(_e,{handleClickCancle:be,handleClickSubmit:xe,content:"최근 본 목록을 모두 삭제하시겠습니까?"}),le&&e.jsx(We,{searchData:a,setSearchData:f,amenityValues:re,setAmenityValues:ce,handleClickCancle:ke,getAmenitySearch:de,content:"편의시설 필터"})]})};export{ht as default};

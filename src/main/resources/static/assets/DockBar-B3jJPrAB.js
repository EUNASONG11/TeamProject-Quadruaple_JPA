import{h as y,o as N,a as S,r as a,g as E,V as _,Q as k,W as C,u as L,i as A,N as c,j as e,L as n,ab as R,p as T,ac as D,ad as B}from"./index-CXgPt5JN.js";import{F as I}from"./index-KjQyUHJh.js";import{u as F}from"./userAtom-DKHhrz4u.js";import{L as P}from"./index-BQ3DKWO0.js";import{s as i}from"./searchAtom-kEitrJec.js";const M=y({key:"resetSearchData",get:({get:r})=>r(i),set:({set:r})=>{r(i,{searchWord:"",searchData:[],start_idx:0,category:0,amenityId:[],orderType:0,more:!0,count:0})}}),U=N.memo(()=>{const x=S().pathname;a.useState(!1);const l=E("accessToken");_(F),k(i);const d=C(M),u=L(),t=a.useRef(null),p=A.EventSourcePolyfill||NativeEventSource,[g,m]=a.useState(null),h=()=>{const s="/api/chat-notice";t.current=new p(s,{headers:{Authorization:`Bearer ${l}`,Connetction:"keep-alive",Accept:"text/event-stream","Cache-Control":"no-cache"},withCredentials:!0}),t.current.onmessage=o=>{console.log("새로운 알림:",o.data)},t.current.addEventListener("connect",o=>{console.log("안 읽은 알림 존재:",typeof o.data),o.data==="false"?m(!1):m(!0)}),t.current.onerror=async()=>{var o;(o=t.current)==null||o.close(),setTimeout(h,3e3)},t.current.onopen=()=>{}};a.useEffect(()=>{if(l)return t.current&&(console.log("기존 SSE 연결 닫기"),t.current.close()),h(),()=>{var s;(s=t.current)==null||s.close()}},[t]);const[v,W]=c.useMessage(),[b,j]=a.useState(!1);a.useEffect(()=>{const s=()=>{j(window.scrollY>100)};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[]);const f=()=>{console.log("info 작동"),v.open({type:"info",content:"로그인이 필요한 서비스입니다.",style:{marginTop:"20vh"}})},w=()=>{window.scrollTo({top:0,behavior:"smooth"})};return e.jsx("div",{children:e.jsxs("div",{className:"flex max-w-[768px] w-full h-auto fixed bottom-0 left-1/2 -translate-x-1/2 bg-white z-50 shadow-[0px_-4px_8px_0px_rgba(99,99,99,0.05)]",children:[e.jsxs(n,{to:"/search/before",className:"text-slate-400 flex flex-1 flex-col justify-center items-center gap-1.5",children:[e.jsx(I,{className:"text-2xl"}),"검색"]}),e.jsxs("button",{type:"button",onClick:()=>{l?u("/search/location"):(f(),c.error("로그인 후 이용 가능한 서비스 입니다"))},className:"text-slate-400 flex flex-1 flex-col justify-center items-center gap-1.5 text-sm",children:[e.jsx(P,{className:"text-2xl"}),"일정"]}),e.jsxs(n,{to:"/",className:"bg-primary text-white w-20 h-20 rounded-full flex flex-col justify-center items-center gap-1.5 relative bottom-5 text-sm",onClick:()=>{d()},children:[e.jsx(R,{className:"text-2xl"}),"홈"]}),e.jsxs(n,{to:"/scheduleboard",className:"text-slate-400 flex flex-1 flex-col justify-center items-center gap-1.5 text-sm",children:[e.jsx(T,{className:"text-2xl"}),"여행기"]}),e.jsxs("button",{type:"button",className:"relative text-slate-400 flex flex-1 flex-col justify-center items-center gap-1.5 text-sm",onClick:()=>{l?u("/chat"):(f(),c.error("로그인 후 이용 가능한 서비스 입니다"))},children:[e.jsx(D,{className:"text-2xl"}),"채팅",e.jsx("div",{className:`absolute top-3 right-1/3 w-2 h-2 bg-primary rounded-full
              ${g?"visible":"invisible"}`})]}),x==="/search/strf"&&e.jsx("div",{className:`absolute bottom-[120px] right-0 -translate-x-1/2 transition-all duration-300 ${b?"opacity-100 visible":"opacity-0 invisible"}`,children:e.jsx("button",{type:"button",className:"bg-primary text-white rounded-full p-[10px] text-[24px] shadow-lg hover:bg-primary/90 transition-colors",onClick:w,children:e.jsx(B,{})})})]})})});export{U as D};

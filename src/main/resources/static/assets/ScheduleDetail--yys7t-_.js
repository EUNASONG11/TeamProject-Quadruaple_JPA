import{u as E,r as i,j as e,M as _,B,g as V,S as W,c as F,ab as G,a4 as q,a0 as H,ay as J,e as j,ai as K}from"./index-DZF_lMwV.js";import{a as Q}from"./index-Ce58HCJJ.js";import{S as X}from"./ScheduleDay-l5D822z2.js";import{S as Y,a as Z}from"./swiper-react-DGr9Ps00.js";import{j as M}from"./jwt-C3mglyXF.js";import{u as ee}from"./userAtom-DuRkhM4A.js";import{R as te}from"./index-C8yBNrXo.js";import{a as se}from"./index-Calry11s.js";import{S as P}from"./index-Bv825Ok0.js";import"./match-DOxPiXvs.js";import"./index-BDHbZjIV.js";import"./index-DWVMhexM.js";import"./index-CqiZLVFA.js";import"./index-BMyrdrr4.js";import"./index-B2_Wd0k0.js";import"./tripAtom-Bk31_AZq.js";import"./MarkerClusterer-EbPm5vli.js";import"./index-DZ82jsPs.js";import"./index-Cbswu_Hk.js";import"./index-D-wHe6FV.js";import"./Portal-hI7XGsNB.js";import"./useId-DRiPHj_v.js";import"./isMobile-DjGTsQxe.js";import"./motion-DnGLBzQj.js";import"./roundedArrow-7xBDnTzZ.js";import"./zoom-CNuMB0di.js";const ae=({openSelectTripModal:p,setOpenSelectTripModal:T,tripLocationList:m,tripReviewId:w})=>{const c=E(),v=()=>{c("/schedule/days",{state:{selectedLocationId:m,tripReviewId:w,tripId:d.tripId,title:d.title,from:"/scheduleboard/scheduleDetail"}})},[x,r]=i.useState([]),[u,n]=i.useState(null),[d,f]=i.useState(null);i.useEffect(()=>{console.log("tripListData",x)},[x]),i.useEffect(()=>{console.log("selectedTripData",d)},[d]);const h=async()=>{try{const t=await M.get("/api/trip-list");console.log(t.data);const b=t.data.data.beforeTripList;r(b)}catch(t){console.log("여행 목록 불러오기:",t)}},y=(t,o)=>{n(o),console.log("item",t),f(t)},g=()=>{T(!1)},N=t=>{t.stopPropagation()};return i.useEffect(()=>{h()},[]),e.jsx("div",{className:`fixed top-0 left-[50%] translate-x-[-50%] z-10\r
\r
            max-w-3xl w-full mx-auto h-screen\r
            flex items-end justify-center\r
            bg-[rgba(0,0,0,0.5)]\r
            pb-[70px]\r
            `,onClick:()=>{g()},children:e.jsxs("div",{className:`bg-white w-full \r
                rounded-t-2xl px-[60px] py-[55px]\r
                flex flex-col gap-[20px]\r
                `,onClick:N,children:[e.jsx("h2",{className:"text-[28px] text-slate-700 font-bold",children:"이 일정을 담을 여행을 선택해주세요."}),e.jsxs("div",{className:"flex flex-col gap-[5px]",children:[e.jsx("h3",{className:"text-[18px] text-slate-700 font-semibold",children:"나의 다가오는 여행"}),e.jsx("ul",{className:`flex flex-col px-[10px] py-[20px] gap-[30px]\r
          max-h-[55vh] overflow-y-auto`,children:x==null?void 0:x.map((t,o)=>e.jsxs("li",{className:`flex items-center gap-[20px] px-[20px] py-[10px] rounded-[16px] ${u===o?"bg-slate-200":""}`,onClick:()=>y(t,o),children:[e.jsx("div",{className:"w-[50px] h-[50px] bg-slate-100 rounded-full overflow-hidden",children:e.jsx("img",{src:`${_}/${t.locationPic}`,alt:"",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-[5px]",children:[e.jsx("h4",{className:"text-[18px] text-slate-700 font-semibold",children:t.title}),e.jsxs("p",{className:"text-[16px] text-slate-500",children:[e.jsx("span",{children:t.startAt}),e.jsx("span",{children:"-"}),e.jsx("span",{children:t.endAt})]})]})]},o))})]}),e.jsx(B,{type:"primary",htmlType:"button",className:"h-[50px] px-[15px] py-[20px] text-[24px] text-white font-semibold",onClick:v,children:"선택 완료"})]})})},$e=()=>{var S,R,k,D,I,$,L,C,A;const p=V("accessToken"),{userId:T}=W(ee),[m]=F(),w=parseInt(m.get("tripId")),c=parseInt(m.get("TripReviewId")),v=E(),x=()=>{v(`/report?category=${K.TRIPREVIEW}&reportTarget=${c}`)},[r,u]=i.useState({}),[n,d]=i.useState({}),[f,h]=i.useState(!1),[y,g]=i.useState(!1),[N,t]=i.useState(!1),o=async()=>{const a="/api/trip-review/otherTripReview";if(t(!0),p)try{const s=await j.get(`${a}?tripReviewId=${c}`,{headers:{Authorization:`Bearer ${p}`}});console.log("다른 사람 여행기 조회",s.data);const l=s.data;t(!1),u(l.data)}catch(s){t(!1),console.log("다른 사람 여행기 조회",s)}if(!p)try{const s=await j.get(`${a}?tripReviewId=${c}`);console.log("다른 사람 여행기 조회",s.data);const l=s.data;t(!1),u(l.data)}catch(s){t(!1),console.log("다른 사람 여행기 조회",s)}},b=async()=>{g(!0);try{const a=await j.get(`/api/trip?trip_id=${w}&signed=false`);console.log("여행확인하기",a.data);const s=a.data.data;d(s)}catch(a){console.log(a)}finally{g(!1)}},O=async()=>{const a="/api/trip-review/like",s={tripReviewId:c};try{const l=await M.post(a,s);console.log("여행기 추천",l.data),l.data.code==="200 성공"&&o()}catch(l){console.log("여행기 추천",l)}},z=async()=>{const a={tripReviewId:c},s="/api/trip-review/like";try{const l=await j.delete(`${s}`,{data:a,headers:{Authorization:`Bearer ${p}`}});console.log("여행기 추천 취소",l.data),l.data.code==="200 성공"&&o()}catch(l){console.log("여행기 추천 취소",l)}};return i.useEffect(()=>{o(),b()},[]),e.jsxs("div",{children:[e.jsx("section",{className:"flex flex-col px-[32px] py-[30px] gap-[30px]",children:e.jsxs(P,{spinning:N,children:[e.jsx(Y,{slidesPerView:1,spaceBetween:0,loop:!0,className:"mySwiper w-full h-[406px] overflow-hidden",children:r.length>0?(R=(S=r[0])==null?void 0:S.tripReviewPics)==null?void 0:R.map((a,s)=>e.jsx(Z,{className:"max-w-3xl h-[406px] bg-slate-200",children:e.jsx("img",{src:`${G}/${r[0].tripReviewId}/${a}`,alt:"thum",className:"w-full h-full object-cover"})},s)):null}),e.jsx("div",{className:"flex flex-col gap-[10px]",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("h2",{className:"font-bold text-[36px] text-slate-700",children:(k=r[0])==null?void 0:k.title}),e.jsxs("ul",{className:"flex gap-[10px] items-center",children:[e.jsxs("li",{className:"flex gap-[5px] items-center",children:[e.jsx(q,{className:"text-slate-300 text-[18px]"}),e.jsx("p",{className:"text-slate-500 font-bold text-[14px]",children:(D=r[0])==null?void 0:D.recentCount})]}),e.jsxs("li",{className:"flex gap-[5px] items-center cursor-pointer",children:[e.jsx(Q,{className:"text-slate-300 text-[18px] focus:text-secondary3 transition-all duration-300"}),e.jsx("button",{type:"button",className:"text-slate-500 font-bold text-[14px]",children:(I=r[0])==null?void 0:I.likeCount})]}),e.jsxs("li",{className:"flex gap-[5px] items-center",children:[e.jsx(H,{className:"text-slate-300 text-[18px]"}),e.jsxs("p",{className:"text-slate-500 font-bold text-[14px]",children:[" ",($=r[0])==null?void 0:$.scrapCount]})]})]})]}),e.jsxs("div",{className:"flex gap-[10px]",children:[p&&e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",className:`w-[50px] h-[50px] flex items-center justify-center
                    rounded-full text-[20px]
                   transition-all duration-300
                   ${((L=r[0])==null?void 0:L.likeUser)===1?"text-secondary3 bg-secondary3/10 hover:bg-secondary3/20":"text-slate-500 bg-slate-200 hover:bg-slate-200/85"}`,onClick:()=>{var a;((a=r[0])==null?void 0:a.likeUser)===0?O():z()},children:e.jsx(se,{})})}),p&&e.jsx("button",{type:"button",className:`w-[50px] h-[50px] flex items-center justify-center
                    rounded-full text-[20px] bg-slate-200 text-slate-500
                   transition-all duration-300
                   hover:bg-slate-200/85`,onClick:x,children:e.jsx(te,{})})]})]})}),e.jsx("div",{className:"py-3",children:e.jsx("p",{children:(C=r[0])==null?void 0:C.content})})]})}),e.jsx("section",{children:e.jsx(P,{spinning:y,children:e.jsx("div",{className:"flex flex-col gap-[50px]",children:(A=n==null?void 0:n.days)==null?void 0:A.map((a,s)=>e.jsx(X,{data:a,newTrip:!1,readOnly:!0},s))})})}),e.jsx("div",{className:"px-8 pb-5 mb-[30px]",children:e.jsxs(B,{type:"primary",variant:"filled",className:"flex gap-[10px] py-[10px] h-auto w-full",onClick:()=>h(!0),classNames:"bg-slate-100",children:[e.jsx(J,{className:"w-[30px] h-[30px] text-white"}),e.jsx("span",{className:"font-semibold text-[24px] text-white",children:"내 여행에 담기"})]})}),f&&e.jsx(ae,{openSelectTripModal:f,setOpenSelectTripModal:h,tripLocationList:n==null?void 0:n.tripLocationList,tripReviewId:c})]})};export{$e as default};

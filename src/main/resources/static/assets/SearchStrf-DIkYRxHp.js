import{u as H,j as e,R as fe,E as ge,r as a,g as O,b as f,e as V,h as je,d as ye,F as Ne,B as be,P as Ce}from"./index-lSgSIVq0.js";import{a as ve}from"./index-W7l60tzT.js";import{C as ke}from"./CenterModal-BSzHFepq.js";import{a as Y}from"./pic-Jp7D6aQ0.js";import{c as G,a as we}from"./match-Bwf83gmQ.js";import{A as Se,a as Re}from"./index-CL3h7xgQ.js";import{R as Ie}from"./index-QJhHY3lT.js";import{L as De}from"./index-zdkvGhim.js";import{F as I}from"./index-DmAzEE9E.js";import{C as U}from"./index-D5aFR8fN.js";import"./index-xOiyq3gC.js";import"./index-DOmuDq51.js";import"./index-76rm2S88.js";import"./index-BITOSm_t.js";import"./Portal-DgKfOFff.js";import"./useId-NRmY-Uhn.js";import"./zoom-JFcaoQzf.js";import"./collapse-BbEVqHco.js";import"./index-BJLQYX5H.js";import"./useLocale-B6HIg25i.js";import"./Checkbox-CN-sUrkH.js";const Te=u=>{u.current.scrollIntoView({behavior:"smooth"})},d=({showMore:u=!0,title:r,categoryData:x,searchValue:h,buttonClick:g})=>{const j=H(),D=l=>{j(`/contents/index?strfId=${l.strfId}`)};return e.jsxs("div",{className:"flex flex-col gap-[20px] items-center",children:[e.jsx("h2",{className:"w-full text-[24px] font-semibold text-slate-700",children:r}),e.jsx("ul",{className:"w-full flex flex-col gap-[20px] mb-[30px]",children:x==null?void 0:x.map((l,y)=>e.jsxs("li",{className:"flex gap-[20px] items-center cursor-pointer",onClick:()=>{D(l)},children:[e.jsx("div",{className:"w-[130px] h-[130px] bg-slate-200 rounded-[8px] overflow-hidden",children:e.jsx("img",{src:`${Y}${l.strfId}/${l.strfPic}`,alt:l.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-[5px]",children:[e.jsx("div",{className:"flex gap-[5px] items-center ",children:e.jsx("h3",{className:"text-[20px] font-semibold text-slate-700",children:l.title||l.strfTitle})}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("p",{className:"text-[14px] text-slate-500",children:G(l.category)}),e.jsx("p",{className:"text-[14px] text-slate-500",children:"|"}),e.jsx("p",{className:"text-[14px] text-slate-500",children:l.locationName})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx(Ie,{disabled:!0,count:1,value:l.hasMyReview!==0?1:0}),e.jsx("p",{className:"text-[12px] text-slate-500",children:l.averageRating?l.averageRating:"0"}),e.jsxs("p",{className:"text-[12px] text-slate-500",children:["(",l.reviewCount.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("div",{children:l.wishIn?e.jsx(Se,{className:"text-secondary3"}):e.jsx(Re,{className:"text-slate-400"})}),e.jsx("p",{className:"text-[12px] text-slate-500",children:l.wishlistCount.toLocaleString()})]})]})]},y))}),u&&e.jsxs("button",{type:"button",className:`px-[20px] py-[10px] border border-slate-300 \r
\r
        rounded-[24px] text-[16px] font-semibold text-slate-600`,onClick:g,children:[r," 검색결과 더보기"]})]})},p=[{type:"all",name:"전체"},{type:"TOUR",name:"관광지"},{type:"STAY",name:"숙소"},{type:"RESTAUR",name:"맛집"},{type:"FEST",name:"축제"}],z=[{type:"ratingAvg",name:"• 평점순"},{type:"reviewCount",name:"• 리뷰순"},{type:"likeCount",name:"• 좋아요순"}],Ze=()=>{var W;const[u]=I.useForm(),[r,x]=fe(ge);a.useEffect(()=>{console.log("searchRecoil",r)},[r]);const h=O("accessToken");(W=O("user"))==null||W.userId;const g=a.useRef(null),j=H(),D=()=>{j(-1),x({...r,searchWord:"",searchData:[],lastIndex:0})},[l,y]=a.useState(r.searchWord!==""),[c,T]=a.useState(r.searchWord||""),[o,A]=a.useState(r.searchData||[]),[M,N]=a.useState(r.lastIndex||0),[b,K]=a.useState([]),[C,q]=a.useState([]),[v,J]=a.useState([]),[i,_]=a.useState(r.category||0),[k,Q]=a.useState(0),[X,$]=a.useState(!1),[Z,L]=a.useState(!1),[w,P]=a.useState(!0),[Ae,ee]=a.useState([]),te=a.useCallback(async()=>{const t="/api/search/popular";try{const s=await f.get(t);K(s.data.data)}catch(s){console.log("인기 검색어",s)}},[]),E=a.useCallback(async()=>{try{const s=(await V.get("/api/search/basic")).data;q(s.data)}catch(t){console.log("최근 본 검색 결과",t)}},[]),se=a.useCallback(async()=>{try{const n=(await V.get("/api/search/list")).data.data.filter(m=>m.txt!=="");J(n)}catch(t){console.log("최근 검색어 호출 결과:",t)}},[]),ae=a.useCallback(async t=>{const s={strf_id:t.strfId};try{const n=await f.patch(`/api/recent/hide?strf_id=${t.strfId}`,{...s},{headers:{Authorization:`Bearer ${h}`}});console.log(n.data),n.data&&E()}catch(n){console.log("개별 삭제",n)}},[]),le=a.useCallback(async()=>{try{const t=await f.patch("/api/recent/hide/all",{},{headers:{Authorization:`Bearer ${h}`}});console.log(t.data),t.data&&(E(),$(!1))}catch(t){console.log("개별 삭제",t)}},[]),F=a.useCallback(async t=>{const s={search_word:t};console.log("전체 검색",s);try{const m=(await f.post(`/api/search/all?search_word=${t}`,s)).data;m&&(L(!0),y(!0)),A(m.data)}catch(n){console.log("전체 검색",n)}},[]),B=a.useCallback(async()=>{try{const t=M,n=(await f.get(`/api/search/category?last_index=${t}&category=${p[i].name}&search_word=${c}&order_type=${z[k].type}`)).data;n&&L(!0),n.data&&n.data.length>0?(A(m=>t===0?n.data:[...m,...n.data]),N(t+10)):P(!1)}catch(t){console.log("카테고리 검색",t)}},[i,M,c,k]),re=o.filter(t=>t.category==="TOUR"),ce=o.filter(t=>t.category==="STAY"),ne=o.filter(t=>t.category==="RESTAUR"),oe=o.filter(t=>t.category==="FEST"),ie=t=>{T(t.target.value)},xe=a.useCallback(t=>{console.log("클릭한 최근 검색어:",t),T(t.txt),F(t.txt)},[]),pe=a.useCallback(t=>{console.log("클릭한 인기 검색어:",t),j(`/contents/index?strfId=${t.strfId}`)},[]),de=a.useCallback(()=>{T("")},[]),he=()=>{$(!1)},me=t=>{c.trim()&&(L(!1),F(t.target.value),x({...r,searchWord:c}),y(!0))},S=t=>{Te(g),_(t),x({...r,category:t})},R=()=>{B()},ue=t=>{console.log("values",t.amenities),ee(t.amenities)};return a.useEffect(()=>{te(),h&&(E(),se())},[]),a.useEffect(()=>{x({...r,searchWord:c})},[c]),a.useEffect(()=>{N(0),A([]),P(!0),x(s=>({...s,lastIndex:0,searchData:[]}));const t=setTimeout(()=>{i!==0?B():F(c)},100);return()=>clearTimeout(t)},[i,k]),a.useEffect(()=>{o.length>0&&x({...r,searchData:o})},[o]),e.jsxs("div",{className:"w-full flex flex-col gap-[30px] mb-[100px]",children:[e.jsxs("div",{className:"w-full px-[32px] py-[30px] flex items-center gap-[40px] relative",ref:g,children:[e.jsx("div",{className:"text-[36px] cursor-pointer",onClick:()=>{D()},children:e.jsx(je,{})}),e.jsx("label",{htmlFor:"searchBar",className:"relative w-full",children:e.jsx(ye,{id:"searchBar",className:"h-[60px] text-lg rounded-lg gap-[5px]",placeholder:"관광지, 장소, 숙소,맛집을 검색해 보세요",allowClear:!0,onClear:de,prefix:e.jsx(Ne,{className:"text-slate-400 text-2xl"}),onChange:ie,onPressEnter:t=>me(t),variant:"filled",value:c})})]}),l?e.jsxs("div",{className:"px-[32px] py-[30px] flex flex-col gap-[30px] min-h-screen",children:[e.jsx("ul",{className:"flex justify-between items-center",children:p.map((t,s)=>e.jsx("li",{className:`cursor-pointer font-semibold text-[16px] w-full flex justify-center items-center px-[15px] py-[10px] gap-[10px] rounded-[8px] ${s===i?"bg-primary text-white":"bg-white text-slate-500"}`,onClick:()=>{N(0),_(s),x({...r,category:s})},children:t.name},s))}),i!==0&&e.jsx("ul",{className:"flex items-center",children:z.map((t,s)=>e.jsx("li",{className:`cursor-pointer font-semibold text-[13px] flex items-center px-3 py-1  ${s===k?"text-primary":"text-slate-500"}`,onClick:()=>{Q(s),N(0)},children:t.name},s))}),i===2&&e.jsxs(I,{form:u,onFinish:ue,children:[e.jsx(I.Item,{name:"amenities",className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-slate-50 cursor-pointer",children:e.jsx(U.Group,{className:"flex flex-wrap gap-2",children:we.map((t,s)=>e.jsx(U,{value:t.amenity_id,children:e.jsxs("div",{className:"flex justify-center items-center gap-2",children:[e.jsx("span",{className:"text-[16px] text-slate-500",children:t.icon}),e.jsx("span",{className:"text-[14px] text-slate-700",children:t.key})]})},s))})}),e.jsx(I.Item,{children:e.jsx(be,{type:"primary",htmlType:"submit",children:"적용"})})]}),Z?o.length===0?e.jsxs("div",{className:"flex flex-col gap-[20px] items-center py-[100px]",children:[e.jsx("i",{className:"text-slate-300 text-[100px]",children:e.jsx(De,{})}),e.jsx("p",{className:"text-slate-400 text-[20px]",children:"검색 결과가 없습니다."})]}):e.jsxs(e.Fragment,{children:[i===0&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx(d,{title:p[1].name,categoryData:re,searchValue:c,buttonClick:()=>{S(1)}}),e.jsx(d,{title:p[2].name,categoryData:ce,searchValue:c,buttonClick:()=>{S(2)}}),e.jsx(d,{title:p[3].name,categoryData:ne,searchValue:c,buttonClick:()=>{S(3)}}),e.jsx(d,{title:p[4].name,categoryData:oe,searchValue:c,buttonClick:()=>{S(4)}})]}),i===1&&e.jsx(d,{title:p[1].name,categoryData:o,searchValue:c,buttonClick:R,showMore:w}),i===2&&e.jsx(d,{title:p[2].name,categoryData:o,searchValue:c,buttonClick:R,showMore:w}),i===3&&e.jsx(d,{title:p[3].name,categoryData:o,searchValue:c,buttonClick:R,showMore:w}),i===4&&e.jsx(d,{title:p[4].name,categoryData:o,searchValue:c,buttonClick:R,showMore:w})]}):e.jsx("div",{className:"flex justify-center items-center h-[50vh]",children:e.jsx(Ce,{color:"#0DD1FD",speedMultiplier:.8})})]}):e.jsxs("div",{className:"px-[32px] flex flex-col gap-[50px]",children:[h&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"최근 검색어"}),e.jsx("ul",{className:"flex gap-[20px] flex-wrap",children:v?v==null?void 0:v.map((t,s)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",onClick:()=>xe(t),children:t.txt},s)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"인기 검색어"}),e.jsx("ul",{className:"flex gap-[20px] flex-wrap",children:b?b==null?void 0:b.map((t,s)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",onClick:()=>pe(t),children:t.strfName},s)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),h&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"최근 본 목록"}),e.jsx("button",{type:"button",className:"text-slate-400 text-[18px]",onClick:()=>$(!0),children:"모두 삭제"})]}),e.jsx("ul",{className:"flex flex-col gap-[20px]",children:C?C==null?void 0:C.map((t,s)=>e.jsxs("li",{className:"flex cursor-pointer items-center justify-between",children:[e.jsxs("div",{className:"flex gap-[15px]",onClick:()=>handleClickList(t),children:[e.jsx("div",{className:"w-[80px] h-[80px] rounded-2xl overflow-hidden",children:e.jsx("img",{className:"w-full h-full object-cover",src:t.strfPic?`${Y}${t.strfId}/${t.strfPic}`:"/images/logo_icon_4.png",alt:t.strfName})}),e.jsxs("div",{className:"flex flex-col gap-[5px] justify-center",children:[e.jsx("div",{className:"text-[18px] text-slate-700 font-semibold",children:t.strfName}),e.jsxs("div",{className:"flex gap-[5px]",children:[e.jsx("span",{className:"text-slate-500 text-[14px]",children:G(t.category)}),e.jsx("span",{className:"text-slate-500 text-[14px]",children:"•"}),e.jsx("span",{className:"text-slate-500 text-[14px]",children:t.locationTitle})]})]})]}),e.jsx("button",{type:"button",className:"text-slate-400 text-[20px]",onClick:()=>ae(t),children:e.jsx(ve,{})})]},s)):null})]})]}),X&&e.jsx(ke,{handleClickCancle:he,handleClickSubmit:le,content:"최근 본 목록을 모두 삭제하시겠습니까?"})]})};export{Ze as default};

import{a as D,j as e,R as se,h as te,m as ae,g as le,r as a,e as h,b as A,f as ce,F as re,P as oe}from"./index-C6bOqW8w.js";import{I as ne}from"./index-CHrNiM1z.js";import{a as xe}from"./index-Ds7IJz17.js";import{s as ie}from"./searchAtom-u68Vfiv8.js";import{C as pe}from"./CenterModal-DgygGMr7.js";import{a as L}from"./pic-BhDB7TmH.js";import{c as _}from"./match-CXPFdkLO.js";import{a as de,b as he}from"./index-dauweciz.js";import{R as me}from"./index-CeB-_bz0.js";import{L as fe}from"./index-DFcp_QJM.js";import"./index-Bdhbbfqu.js";import"./index-BpHAwgWG.js";import"./Portal-B5J00w0m.js";import"./useId-CKoVMJQW.js";import"./zoom-CUKaUUev.js";const ue=c=>{console.log(c),console.log(`${c}로 이동`),c.current.scrollIntoView({behavior:"smooth"})},m=({title:c,categoryData:i,searchValue:S,buttonClick:p})=>{const f=D(),u=l=>{f(`/contents/index?strfId=${l.strfId}`)};return e.jsxs("div",{className:"flex flex-col gap-[20px] items-center",children:[e.jsx("h2",{className:"w-full text-[24px] font-semibold text-slate-700",children:c}),e.jsx("ul",{className:"w-full flex flex-col gap-[20px] mb-[30px]",children:i==null?void 0:i.map((l,b)=>e.jsxs("li",{className:"flex gap-[20px] items-center cursor-pointer",onClick:()=>{u(l)},children:[e.jsx("div",{className:"w-[130px] h-[130px] bg-slate-200 rounded-[8px] overflow-hidden",children:e.jsx("img",{src:`${L}${l.strfId}/${l.strfPic}`,alt:l.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-[5px]",children:[e.jsx("div",{className:"flex gap-[5px] items-center ",children:e.jsx("h3",{className:"text-[20px] font-semibold text-slate-700",children:l.title||l.strfTitle})}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("p",{className:"text-[14px] text-slate-500",children:_(l.category)}),e.jsx("p",{className:"text-[14px] text-slate-500",children:"|"}),e.jsx("p",{className:"text-[14px] text-slate-500",children:l.locationName})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx(me,{disabled:!0,count:1,value:l.hasMyReview!==0?1:0}),e.jsx("p",{className:"text-[12px] text-slate-500",children:l.averageRating?l.averageRating:"0"}),e.jsxs("p",{className:"text-[12px] text-slate-500",children:["(",l.reviewCount.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("div",{children:l.wishIn?e.jsx(de,{className:"text-secondary3"}):e.jsx(he,{className:"text-slate-400"})}),e.jsx("p",{className:"text-[12px] text-slate-500",children:l.wishlistCount.toLocaleString()})]})]})]},b))}),showMore&&e.jsxs("button",{type:"button",className:`px-[20px] py-[10px] border border-slate-300 \r
\r
        rounded-[24px] text-[16px] font-semibold text-slate-600`,onClick:p,children:[c," 검색결과 더보기"]})]})},d=[{type:"all",name:"전체"},{type:"TOUR",name:"관광지"},{type:"STAY",name:"숙소"},{type:"RESTAUR",name:"맛집"},{type:"FEST",name:"축제"}],T=[{type:"ratingAvg",name:"평점순"},{type:"reviewCount",name:"리뷰순"},{type:"likeCount",name:"좋아요순"}],De=()=>{const[c,i]=se(ie),{userId:S}=te(ae),p=le("accessToken"),f=a.useRef(null),u=D(),[l,b]=a.useState(!!c.searchWord),[o,E]=a.useState(c.searchWord||""),[r,R]=a.useState(c.searchData||[]),[C,I]=a.useState(c.lastIndex||0),[g,P]=a.useState([]),[j,F]=a.useState([]),[N,M]=a.useState([]),[x,B]=a.useState(0),[v,O]=a.useState(0),[U,w]=a.useState(!1),[V,W]=a.useState(!1),z=a.useCallback(async()=>{const s="/api/search/popular";try{const t=await h.get(s);P(t.data.data)}catch(t){console.log("인기 검색어",t)}},[]),k=a.useCallback(async()=>{try{const t=(await A.get(`/api/search/basic?user_id=${S}`)).data;F(t.data)}catch(s){console.log("최근 본 검색 결과",s)}},[]),H=a.useCallback(async()=>{try{const n=(await A.get("/api/search/list")).data.data.filter(ee=>ee.txt!=="");M(n)}catch(s){console.log("최근 검색어 호출 결과:",s)}},[]),Y=a.useCallback(async s=>{const t={strf_id:s.strfId};try{const n=await h.patch(`/api/recent/hide?strf_id=${s.strfId}`,{...t},{headers:{Authorization:`Bearer ${p}`}});console.log(n.data),n.data&&k()}catch(n){console.log("개별 삭제",n)}},[]),K=a.useCallback(async()=>{try{const s=await h.patch("/api/recent/hide/all",{},{headers:{Authorization:`Bearer ${p}`}});console.log(s.data),s.data&&(k(),w(!1))}catch(s){console.log("개별 삭제",s)}},[]),q=a.useCallback(async()=>{const s={search_word:o};console.log("sendData",s);try{const t=await h.post(`/api/search/all?search_word=${o}`,s);console.log(t.data);const n=t.data;n&&W(!0),R(n.data)}catch(t){console.log("전체 검색",t)}},[]),$=a.useCallback(async()=>{try{const s=await h.get(`/api/search/category?
    last_index=${C}&
    category=${d[x].type}&
    search_word=${o}&
    order_type=${T[v].type}`);console.log("카테고리 검색",s.data);const t=s.data;R([...r,...t.data]),I(n=>n+10)}catch(s){console.log("카테고리 검색",s)}},[]);r.filter(s=>s.category==="TOUR"),r.filter(s=>s.category==="STAY"),r.filter(s=>s.category==="RESTAUR"),r.filter(s=>s.category==="FEST");const G=s=>{E(s.target.value)},J=a.useCallback(s=>{console.log("클릭한 최근 검색어:",s)},[]),Q=a.useCallback(s=>{console.log("클릭한 인기 검색어:",s),u(`/contents/index?strfId=${s.strfId}`)},[]),X=()=>{w(!1)},Z=()=>{q(o),i({...c,searchWord:o}),b(!0)},y=()=>{$()};return a.useEffect(()=>{z(),p&&(k(),H())},[]),a.useEffect(()=>{console.log("searchValue",o)},[o]),a.useEffect(()=>{i({...c,lastIndex:C})},[C]),a.useEffect(()=>{I(0),$()},[v,x]),a.useEffect(()=>{r.length>0&&i({...c,searchData:r})},[r]),e.jsxs("div",{className:"w-full flex flex-col gap-[30px] mb-[100px]",children:[e.jsxs("div",{className:"w-full px-[32px] py-[30px] flex items-center gap-[40px] relative",children:[e.jsx("div",{className:"text-[36px] cursor-pointer",onClick:()=>{u(-1)},children:e.jsx(ne,{})}),e.jsx("label",{htmlFor:"searchBar",className:"relative w-full",children:e.jsx(ce,{id:"searchBar",className:"h-[60px] text-lg rounded-lg gap-[5px]",placeholder:"관광지, 장소, 숙소,맛집을 검색해 보세요",allowClear:!0,prefix:e.jsx(re,{className:"text-slate-400 text-2xl"}),onChange:s=>G(s),onPressEnter:()=>Z(),variant:"filled"})})]}),l?e.jsxs("div",{className:"px-[32px] py-[30px] flex flex-col gap-[30px] min-h-screen",children:[e.jsx("ul",{className:"flex justify-between items-center",ref:f,children:d.map((s,t)=>e.jsx("li",{className:`cursor-pointer font-semibold text-[16px] w-full flex justify-center items-center px-[15px] py-[10px] gap-[10px] rounded-[8px] ${t===x?"bg-primary text-white":"bg-white text-slate-500"}`,onClick:()=>{B(t)},children:s.name},t))}),e.jsx("ul",{className:"flex items-center",children:T.map((s,t)=>e.jsx("li",{className:`cursor-pointer font-semibold text-[13px] w-full flex justify-center items-center px-[10px] py-[5px] gap-[10px] ${t===v?"text-primary":"text-slate-500"}`,onClick:()=>O(t),children:s.name},t))}),x===2&&e.jsx("ul",{className:"flex flex-wrap gap-[10px]",children:amenities.map((s,t)=>e.jsx("li",{children:s.name},t))}),V?r.length===0?e.jsxs("div",{className:"flex flex-col gap-[20px] items-center py-[100px]",children:[e.jsx("i",{className:"text-slate-300 text-[100px]",children:e.jsx(fe,{})}),e.jsx("p",{className:"text-slate-400 text-[20px]",children:"검색 결과가 없습니다."})]}):(x===0&&d.slice(1).map((s,t)=>e.jsx(m,{title:s.name,categoryData:s.data,searchValue:o,buttonClick:ue(f)},t)),x===1&&(d[1].name,index),x===2&&(d[2].name,index),x===3&&(d[3].name,index),x===4&&e.jsx(m,{title:d[4].name,categoryData:r,searchValue:o,buttonClick:y},index)):e.jsx("div",{className:"flex justify-center items-center h-[50vh]",children:e.jsx(oe,{color:"#0DD1FD",speedMultiplier:.8})})]}):e.jsxs("div",{className:"px-[32px] flex flex-col gap-[50px]",children:[p&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"최근 검색어"}),e.jsx("ul",{className:"flex gap-[20px] flex-wrap",children:N?N==null?void 0:N.map((s,t)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",onClick:()=>J(s),children:s.txt},t)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"인기 검색어"}),e.jsx("ul",{className:"flex gap-[20px] flex-wrap",children:g?g==null?void 0:g.map((s,t)=>e.jsx("li",{className:"cursor-pointer text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",onClick:()=>Q(s),children:s.strfName},t)):e.jsx("li",{className:"text-slate-700 bg-slate-50 px-[20px] py-[10px] rounded-[20px]",children:"데이터 없음"})})]}),p&&e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-[24px] font-semibold text-slate-700",children:"최근 본 목록"}),e.jsx("button",{type:"button",className:"text-slate-400 text-[18px]",onClick:()=>w(!0),children:"모두 삭제"})]}),e.jsx("ul",{className:"flex flex-col gap-[20px]",children:j?j==null?void 0:j.map((s,t)=>e.jsxs("li",{className:"flex cursor-pointer items-center justify-between",children:[e.jsxs("div",{className:"flex gap-[15px]",onClick:()=>handleClickList(s),children:[e.jsx("div",{className:"w-[80px] h-[80px] rounded-2xl overflow-hidden",children:e.jsx("img",{className:"w-full h-full object-cover",src:s.strfPic?`${L}${s.strfId}/${s.strfPic}`:"/images/logo_icon_4.png",alt:s.strfName})}),e.jsxs("div",{className:"flex flex-col gap-[5px] justify-center",children:[e.jsx("div",{className:"text-[18px] text-slate-700 font-semibold",children:s.strfName}),e.jsxs("div",{className:"flex gap-[5px]",children:[e.jsx("span",{className:"text-slate-500 text-[14px]",children:_(s.category)}),e.jsx("span",{className:"text-slate-500 text-[14px]",children:"•"}),e.jsx("span",{className:"text-slate-500 text-[14px]",children:s.locationTitle})]})]})]}),e.jsx("button",{type:"button",className:"text-slate-400 text-[20px]",onClick:()=>Y(s),children:e.jsx(xe,{})})]},t)):null})]})]}),U&&e.jsx(pe,{handleClickCancle:X,handleClickSubmit:K,content:"최근 본 목록을 모두 삭제하시겠습니까?"})]})};export{De as default};

import{R as v,b as Y,u as w,r as p,j as e,a$ as C,S as I,a4 as f,B as u,g as b,M as k,c as g}from"./index-BimvysYt.js";import{d as m}from"./dayjs.min-B9EaxONI.js";import{c as M}from"./customParseFormat-DnJrZsXc.js";import{o as B}from"./index-CBTeAnO8.js";import{D as $}from"./index-BDGXdd6B.js";import{N as L}from"./NoData-DUSqYxq7.js";import{S}from"./index-D-WNZDT8.js";import"./PurePanel-JLGR16VI.js";import"./index-DYQH-41S.js";import"./Portal-Bk9kCZLz.js";import"./useId-BXEVvoiT.js";import"./isMobile-B4CO7CVJ.js";import"./Overflow-BB9KqhAD.js";import"./useIcons-DwCxqXJp.js";import"./CheckOutlined-COcI-6Bc.js";import"./DownOutlined-BZCNDyF5.js";import"./roundedArrow-IL0Hi0Qw.js";import"./useLocale-DPSLmQeZ.js";import"./index-DLTftulB.js";const j=v({key:"bookingAtom",default:{date:[],bookingList:[]}});m.extend(M);const O=({item:s})=>{console.log("item",s);const[t]=Y(),n=t.get("strfId"),x=w(),o=()=>{x(`/business/booking/detail?strfId=${n}&bookingId=${s.bookingId}&state=${s.state}`)},[l,a]=p.useState(!1),[r,c]=p.useState(!1),d=i=>{switch(i){case"0":return"결제완료";case"1":return"예약확정";case"2":return"이용완료";case"3":return"취소완료"}},y=i=>{switch(i){case"0":return"bg-[rgba(255,253,204,0.6)] text-[#FFCC00]";case"1":return"bg-[rgba(165,238,254,0.3)] text-primary";case"2":return"bg-slate-100 text-slate-400";case"3":return"bg-[rgba(253,180,161,0.3)] text-secondary3"}},h=(i,N)=>N.diff(i,"day"),D=i=>{switch(i){case"0":case"1":return e.jsxs(e.Fragment,{children:[e.jsx(u,{color:"primary",variant:"filled",className:"w-full h-auto py-3 rounded-lg text-base font-semibold text-primary3 ",onClick:()=>c(!0),children:"예약 취소"}),e.jsx(u,{type:"primary",className:"w-full h-auto py-3 rounded-lg text-base font-semibold ",onClick:()=>a(!0),children:"예약 승인"})]});case"2":return e.jsx(e.Fragment,{children:e.jsx(u,{className:"w-full h-auto py-3 rounded-lg text-base font-semibold bg-primary2 text-slate-700",onClick:()=>c(!0),children:"예약 취소"})});case"3":return e.jsx(e.Fragment,{children:e.jsx(u,{className:"w-full h-auto py-3 rounded-lg text-base font-semibold text-slate-700",disabled:!0,children:"예약 취소 완료"})})}};return e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"px-4 py-3 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-start justify-between h-[10vw] max-h-[60px] border-b border-slate-200 ",children:[e.jsx("p",{children:"생성 날짜"}),e.jsxs("button",{type:"button",className:"flex gap-1 items-center text-primary",onClick:o,children:[e.jsx("p",{children:"상세보기"}),e.jsx("i",{children:e.jsx(C,{})})]})]}),e.jsxs("section",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:`w-fit flex items-center justify-center px-2 py-1 text-sm font-bold ${y(s.state)}`,children:e.jsx("p",{children:d(s.state)})}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:s.title})}),e.jsxs("div",{className:"flex items-start gap-5",children:[e.jsx("div",{className:"w-20 aspect-square rounded-2xl bg-slate-200 overflow-hidden",children:e.jsx("img",{src:`${I}/${n}/${s.picName}`,alt:s.title,className:"w-full h-full"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-base text-slate-700",children:`${s.checkInDate} ~ ${s.checkOutDate}`}),e.jsxs("p",{className:"text-slate-500 text-sm",children:[h(m(s.checkInDate,"YYYY-MM-DD dd"),m(s.checkOutDate,"YYYY-MM-DD dd")),"박"," ",h(m(s.checkInDate,"YYYY-MM-DD dd"),m(s.checkOutDate,"YYYY-MM-DD dd"))+1,"일, 체크인 ",s.checkInTime,", 체크아웃 ",s.checkOutTime]}),e.jsxs("p",{className:"text-slate-500 text-sm",children:[s.totalPayment.toLocaleString(),"원"]})]})]})]}),e.jsx("div",{className:"flex items-center gap-3 w-full",children:D(s.state)})]})]}),l&&e.jsx(f,{title:"예약 승인",content:"해당 예약을 승인하시겠습니까?",handleClickSubmit:()=>{},handleClickCancle:()=>a(!1)}),r&&e.jsx(f,{title:"예약 취소",content:"해당 예약을 취소하시겠습니까?",handleClickSubmit:()=>{},handleClickCancle:()=>c(!1)})]})},F=()=>{const s=b("accessToken"),[t,n]=k(j);console.log("bookingData",t);const x=async()=>{var l;const o="/api/business/my-page/booking";try{const r=(await g.get(`${o}?startDate=${t.date[0]}&endDate=${t.date[1]}`,{headers:{Authorization:`Bearer ${s}`}})).data;return console.log("예약 목록 확인",r),r&&n({...t,bookingList:r}),r}catch(a){return g.isAxiosError(a)&&(((l=a.response)==null?void 0:l.status)===404?(console.log("404 정보 없음",a.response.data),n({...t,bookingList:[]})):console.log("예약 목록 확인",a)),null}};return e.jsxs("div",{className:"p-4 flex flex-col gap-3",children:[e.jsxs("div",{className:"px-5 py-4 flex gap-3 border border-slate-200 rounded-lg items-center",children:[e.jsx("i",{className:"text-3xl text-slate-500",children:e.jsx(B,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"px-3 text-sm text-slate-700",children:"날짜 직접 선택"}),e.jsx($.RangePicker,{placeholder:["검색필터 시작일","검색필터 종료일"],variant:"borderless",suffixIcon:!1,onChange:o=>{console.log(o),o&&n({...t,date:o.map(l=>l?l.format("YYYY-MM-DD"):"")})}})]})]}),e.jsx(u,{type:"primary",className:"text-xl py-1 max-h-[50px] h-[16vw]",onClick:x,children:"검색하기"})]})},te=()=>{const s=b("accessToken"),[t,n]=k(j),[x,o]=p.useState(!1),l=async()=>{var r;const a="/api/business/my-page/booking";o(!0);try{const d=(await g.get(a,{headers:{Authorization:`Bearer ${s}`}})).data;return console.log("예약 목록 확인",d),d&&(o(!1),n({...t,bookingList:d})),d}catch(c){return g.isAxiosError(c)&&(o(!1),((r=c.response)==null?void 0:r.status)===404?(console.log("404 정보 없음",c.response.data),n({...t,bookingList:[]})):console.log("예약 목록 확인",c)),null}};return p.useEffect(()=>{l()},[]),e.jsxs("div",{children:[e.jsx(F,{}),e.jsxs(S,{spinning:x,children:[t.bookingList.length===0&&e.jsx(L,{content:"예약이 없습니다"}),t.bookingList.length>0&&t.bookingList.map((a,r)=>e.jsx(O,{item:a},r))]})]})};export{te as default};
